¯ä
∞D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\UseCases\PortfolioUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
UseCases& .
{ 
public 

class 
PortfolioUseCase !
:" #
IPortfolioUseCase$ 5
{ 
private 
readonly  
IPortfolioRepository - 
_portfolioRepository. B
;B C
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
const 
int 
rowDate !
=" #
$num$ %
;% &
private 
readonly 
string #
uploadServerFileUrlPath  7
;7 8
private 
readonly 
string $
uploadServerFolderSource  8
;8 9
private 
readonly 
string %
downloadServerFileUrlPath  9
;9 :
private 
readonly 
string +
downloadServerFolderDestination  ?
;? @
private   
readonly   
string   
fileName    (
;  ( )
private!! 
readonly!! 
string!! 
contentType!!  +
;!!+ ,
private"" 
readonly"" 
string"" 
[""  
]""  !

originList""" ,
=""- .
[""/ 0
$str""0 :
,"": ;
$str""< D
]""D E
;""E F
private## 
string## 
procedencia## "
=### $
string##% +
.##+ ,
Empty##, 1
;##1 2
public&& 
PortfolioUseCase&& 
(&&   
IPortfolioRepository&&  4
portfolioRepository&&5 H
,&&H I
IConfiguration&&J X
configuration&&Y f
)&&f g
{'' 	 
_portfolioRepository((  
=((! "
portfolioRepository((# 6
;((6 7
_configuration)) 
=)) 
configuration)) *
;))* +#
uploadServerFileUrlPath++ #
=++$ %
_configuration++& 4
.++4 5

GetSection++5 ?
(++? @
$str++@ L
)++L M
.++M N

GetSection++N X
(++X Y
$str++Y l
)++l m
.++m n
Value++n s
!++s t
;++t u$
uploadServerFolderSource,, $
=,,% &
_configuration,,' 5
.,,5 6

GetSection,,6 @
(,,@ A
$str,,A M
),,M N
.,,N O

GetSection,,O Y
(,,Y Z
$str,,Z n
),,n o
.,,o p
Value,,p u
!,,u v
;,,v w
fileName-- 
=-- 
_configuration-- %
.--% &

GetSection--& 0
(--0 1
$str--1 =
)--= >
.--> ?

GetSection--? I
(--I J
$str--J T
)--T U
.--U V
Value--V [
!--[ \
;--\ ]
contentType.. 
=.. 
_configuration.. (
...( )

GetSection..) 3
(..3 4
$str..4 @
)..@ A
...A B

GetSection..B L
(..L M
$str..M ^
)..^ _
..._ `
Value..` e
!..e f
;..f g%
downloadServerFileUrlPath00 %
=00& '
_configuration00( 6
.006 7

GetSection007 A
(00A B
$str00B P
)00P Q
.00Q R

GetSection00R \
(00\ ]
$str00] p
)00p q
.00q r
Value00r w
!00w x
;00x y+
downloadServerFolderDestination11 +
=11, -
_configuration11. <
.11< =

GetSection11= G
(11G H
$str11H V
)11V W
.11W X

GetSection11X b
(11b c
$str11c |
)11| }
.11} ~
Value	11~ É
!
11É Ñ
;
11Ñ Ö
}22 	
public99 
async99 
Task99 
<99 
ResponseDTO99 %
>99% &
CreatePortfolio99' 6
(996 7
PortafolioCreateDTO997 J
request99K R
)99R S
{:: 	
ResponseDTO;; 
response;;  
=;;! "
new;;# &
ResponseDTO;;' 2
(;;2 3
);;3 4
;;;4 5
try<< 
{== 

Portafolio?? 
model??  
=??! "
new??# &

Portafolio??' 1
{@@ 

F_PosicionAA 
=AA  
requestAA! (
.AA( )

F_PosicionAA) 3
,AA3 4

ListaDatosBB 
=BB  
requestBB! (
.BB( )

ListaDatosBB) 3
,BB3 4
NombrePortafolioCC $
=CC% &
requestCC' .
!CC. /
.CC/ 0
NombrePortafolioCC0 @
,CC@ A
SubPortafolioIdDD #
=DD$ %
requestDD& -
!DD- .
.DD. /
SubPortafolioIdDD/ >
}EE 
;EE 
responseGG 
.GG 
	ResultadoGG "
=GG# $
awaitGG% * 
_portfolioRepositoryGG+ ?
.GG? @
AddAsyncGG@ H
(GGH I
modelGGI N
)GGN O
;GGO P
responseHH 
.HH 
	IsExitosoHH "
=HH# $
trueHH% )
;HH) *
responseII 
.II 
MensajeII  
=II! "
$strII# ?
;II? @
responseJJ 
.JJ 

StatusCodeJJ #
=JJ$ %
HttpStatusCodeJJ& 4
.JJ4 5
OKJJ5 7
;JJ7 8
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
responseNN 
.NN 
	IsExitosoNN "
=NN# $
falseNN% *
;NN* +
responseOO 
.OO 
ErrorMessagesOO &
.OO& '
AddOO' *
(OO* +"
ExceptionMessageHelperOO+ A
.OOA B
GetExceptionMessageOOB U
(OOU V
exOOV X
)OOX Y
)OOY Z
;OOZ [
responsePP 
.PP 

StatusCodePP #
=PP$ %
HttpStatusCodePP& 4
.PP4 5

BadRequestPP5 ?
;PP? @
}QQ 
returnSS 
responseSS 
;SS 
}TT 	
public[[ 
async[[ 
Task[[ 
<[[ 
ResponseDTO[[ %
>[[% &
DeletePortfolio[[' 6
([[6 7
int[[7 :
id[[; =
)[[= >
{\\ 	
ResponseDTO]] 
response]]  
=]]! "
new]]# &
ResponseDTO]]' 2
(]]2 3
)]]3 4
;]]4 5
if__ 
(__ 
id__ 
==__ 
$num__ 
)__ 
{`` 
responseaa 
.aa 
	IsExitosoaa "
=aa# $
falseaa% *
;aa* +
responsebb 
.bb 

StatusCodebb #
=bb$ %
HttpStatusCodebb& 4
.bb4 5

BadRequestbb5 ?
;bb? @
returncc 
responsecc 
;cc  
}dd 
tryff 
{gg 
varhh 
deletePortfoliohh #
=hh$ %
awaithh& +
thishh, 0
.hh0 1
GetPortfolioByIdhh1 A
(hhA B
idhhB D
)hhD E
;hhE F
ifii 
(ii 
deletePortfolioii #
==ii$ &
nullii' +
||ii, .
(ii/ 0
deletePortfolioii0 ?
!=ii@ B
nulliiC G
&&iiH J
!iiK L
deletePortfolioiiL [
.ii[ \
	IsExitosoii\ e
)iie f
)iif g
{jj 
returnkk 
deletePortfoliokk *
!kk* +
;kk+ ,
}ll 
responsenn 
.nn 
	Resultadonn "
=nn# $
awaitnn% * 
_portfolioRepositorynn+ ?
.nn? @
DeleteAsyncnn@ K
(nnK L
idnnL N
)nnN O
;nnO P
responseoo 
.oo 
	IsExitosooo "
=oo# $
trueoo% )
;oo) *
responsepp 
.pp 
Mensajepp  
=pp! "
$strpp# B
;ppB C
responseqq 
.qq 

StatusCodeqq #
=qq$ %
Systemqq& ,
.qq, -
Netqq- 0
.qq0 1
HttpStatusCodeqq1 ?
.qq? @
OKqq@ B
;qqB C
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
responseuu 
.uu 
	IsExitosouu "
=uu# $
falseuu% *
;uu* +
responsevv 
.vv 
ErrorMessagesvv &
.vv& '
Addvv' *
(vv* +"
ExceptionMessageHelpervv+ A
.vvA B
GetExceptionMessagevvB U
(vvU V
exvvV X
)vvX Y
)vvY Z
;vvZ [
responseww 
.ww 

StatusCodeww #
=ww$ %
HttpStatusCodeww& 4
.ww4 5

BadRequestww5 ?
;ww? @
}xx 
returnzz 
responsezz 
;zz 
}{{ 	
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
<
ÅÅ 
ResponseDTO
ÅÅ %
>
ÅÅ% &
GetAllPortfolio
ÅÅ' 6
(
ÅÅ6 7
)
ÅÅ7 8
{
ÇÇ 	
ResponseDTO
ÉÉ 
response
ÉÉ  
=
ÉÉ! "
new
ÉÉ# &
ResponseDTO
ÉÉ' 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
try
ÑÑ 
{
ÖÖ 
response
ÜÜ 
.
ÜÜ 
	Resultado
ÜÜ "
=
ÜÜ# $
await
ÜÜ% *"
_portfolioRepository
ÜÜ+ ?
.
ÜÜ? @
GetAllAsync
ÜÜ@ K
(
ÜÜK L
)
ÜÜL M
;
ÜÜM N
response
áá 
.
áá 
	IsExitoso
áá "
=
áá# $
true
áá% )
;
áá) *
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ää 
response
ãã 
.
ãã 
	IsExitoso
ãã "
=
ãã# $
false
ãã% *
;
ãã* +
response
åå 
.
åå 
ErrorMessages
åå &
.
åå& '
Add
åå' *
(
åå* +$
ExceptionMessageHelper
åå+ A
.
ååA B!
GetExceptionMessage
ååB U
(
ååU V
ex
ååV X
)
ååX Y
)
ååY Z
;
ååZ [
}
çç 
return
èè 
response
èè 
;
èè 
}
êê 	
public
óó 
async
óó 
Task
óó 
<
óó 
ResponseDTO
óó %
>
óó% & 
GetPortfolioByDate
óó' 9
(
óó9 :
string
óó: @
positionDate
óóA M
)
óóM N
{
òò 	
ResponseDTO
ôô 
response
ôô  
=
ôô! "
new
ôô# &
ResponseDTO
ôô' 2
(
ôô2 3
)
ôô3 4
;
ôô4 5
try
õõ 
{
úú 
List
üü 
<
üü 
object
üü 
>
üü 
filters
üü $
=
üü% &
new
üü' *
List
üü+ /
<
üü/ 0
object
üü0 6
>
üü6 7
(
üü7 8
)
üü8 9
{
üü: ;
new
†† 
{
†† 

F_Posicion
°° "
=
°°# $
positionDate
°°% 1
}
¢¢ 
}
££ 
;
££ 
IEnumerable
§§ 
<
§§ 

Portafolio
§§ &
>
§§& '
portfolioList
§§( 5
=
§§6 7
await
§§8 ="
_portfolioRepository
§§> R
.
§§R S
GetAllAsync
§§S ^
(
§§^ _
filters
§§_ f
)
§§f g
;
§§g h
if
•• 
(
•• 
!
•• 
portfolioList
•• "
!
••" #
.
••# $
Any
••$ '
(
••' (
)
••( )
)
••) *
{
¶¶ 
response
ßß 
.
ßß 
	IsExitoso
ßß &
=
ßß' (
false
ßß) .
;
ßß. /
response
®® 
.
®® 
ErrorMessages
®® *
.
®®* +
Add
®®+ .
(
®®. /
$str
®®/ V
)
®®V W
;
®®W X
response
©© 
.
©© 

StatusCode
©© '
=
©©( )
HttpStatusCode
©©* 8
.
©©8 9
NotFound
©©9 A
;
©©A B
return
™™ 
response
™™ #
;
™™# $
}
´´ 
response
¨¨ 
.
¨¨ 
	Resultado
¨¨ "
=
¨¨# $
portfolioList
¨¨% 2
;
¨¨2 3
response
≠≠ 
.
≠≠ 
	IsExitoso
≠≠ "
=
≠≠# $
response
≠≠% -
.
≠≠- .
	Resultado
≠≠. 7
!=
≠≠8 :
null
≠≠; ?
;
≠≠? @
response
ÆÆ 
.
ÆÆ 

StatusCode
ÆÆ #
=
ÆÆ$ %
HttpStatusCode
ÆÆ& 4
.
ÆÆ4 5
OK
ÆÆ5 7
;
ÆÆ7 8
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞  
{
±± 
response
≤≤ 
.
≤≤ 
	IsExitoso
≤≤ "
=
≤≤# $
false
≤≤% *
;
≤≤* +
response
≥≥ 
.
≥≥ 
ErrorMessages
≥≥ &
.
≥≥& '
Add
≥≥' *
(
≥≥* +$
ExceptionMessageHelper
≥≥+ A
.
≥≥A B!
GetExceptionMessage
≥≥B U
(
≥≥U V
ex
≥≥V X
)
≥≥X Y
)
≥≥Y Z
;
≥≥Z [
}
¥¥ 
return
∂∂ 
response
∂∂ 
;
∂∂ 
}
∑∑ 	
public
ææ 
async
ææ 
Task
ææ 
<
ææ 
ResponseDTO
ææ %
>
ææ% &
GetPortfolioById
ææ' 7
(
ææ7 8
int
ææ8 ;
id
ææ< >
)
ææ> ?
{
øø 	
ResponseDTO
¿¿ 
response
¿¿  
=
¿¿! "
new
¿¿# &
ResponseDTO
¿¿' 2
(
¿¿2 3
)
¿¿3 4
;
¿¿4 5
try
¬¬ 
{
√√ 
response
ƒƒ 
.
ƒƒ 
	Resultado
ƒƒ "
=
ƒƒ# $
await
ƒƒ% *"
_portfolioRepository
ƒƒ+ ?
.
ƒƒ? @
GetByIdAsync
ƒƒ@ L
(
ƒƒL M
id
ƒƒM O
)
ƒƒO P
;
ƒƒP Q
response
≈≈ 
.
≈≈ 
	IsExitoso
≈≈ "
=
≈≈# $
response
≈≈% -
.
≈≈- .
	Resultado
≈≈. 7
!=
≈≈8 :
null
≈≈; ?
;
≈≈? @
response
∆∆ 
.
∆∆ 

StatusCode
∆∆ #
=
∆∆$ %
HttpStatusCode
∆∆& 4
.
∆∆4 5
OK
∆∆5 7
;
∆∆7 8
if
«« 
(
«« 
response
«« 
.
«« 
	Resultado
«« &
==
««' )
null
««* .
)
««. /
{
»» 
response
…… 
.
…… 
Mensaje
…… $
=
……% &
$str
……' @
;
……@ A
response
   
.
   

StatusCode
   '
=
  ( )
HttpStatusCode
  * 8
.
  8 9
NotFound
  9 A
;
  A B
return
ÀÀ 
response
ÀÀ #
;
ÀÀ# $
}
ÃÃ 
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
œœ 
response
–– 
.
–– 
	IsExitoso
–– "
=
––# $
false
––% *
;
––* +
response
—— 
.
—— 
ErrorMessages
—— &
.
——& '
Add
——' *
(
——* +$
ExceptionMessageHelper
——+ A
.
——A B!
GetExceptionMessage
——B U
(
——U V
ex
——V X
)
——X Y
)
——Y Z
;
——Z [
}
““ 
return
‘‘ 
response
‘‘ 
;
‘‘ 
}
’’ 	
public
›› 
async
›› 
Task
›› 
<
›› 
ResponseDTO
›› %
>
››% &
UpdatePortfolio
››' 6
(
››6 7
int
››7 :
portafolioId
››; G
,
››G H!
PortafolioUpdateDTO
››I \
request
››] d
)
››d e
{
ﬁﬁ 	
ResponseDTO
ﬂﬂ 
response
ﬂﬂ  
=
ﬂﬂ! "
new
ﬂﬂ# &
ResponseDTO
ﬂﬂ' 2
(
ﬂﬂ2 3
)
ﬂﬂ3 4
;
ﬂﬂ4 5
if
·· 
(
·· 
portafolioId
·· 
==
·· 
$num
··  !
||
··" $
(
··% &
request
··& -
==
··. 0
null
··1 5
||
··6 8
string
··9 ?
.
··? @
IsNullOrEmpty
··@ M
(
··M N
request
··N U
.
··U V

ListaDatos
··V `
)
··` a
)
··a b
)
··b c
{
‚‚ 
response
„„ 
.
„„ 
	IsExitoso
„„ "
=
„„# $
false
„„% *
;
„„* +
response
‰‰ 
.
‰‰ 

StatusCode
‰‰ #
=
‰‰$ %
HttpStatusCode
‰‰& 4
.
‰‰4 5

BadRequest
‰‰5 ?
;
‰‰? @
return
ÂÂ 
response
ÂÂ 
;
ÂÂ  
}
ÊÊ 
try
ËË 
{
ÈÈ 
var
ÍÍ 
updatePortfolio
ÍÍ #
=
ÍÍ$ %
await
ÍÍ& +"
_portfolioRepository
ÍÍ, @
.
ÍÍ@ A
GetByIdAsync
ÍÍA M
(
ÍÍM N
portafolioId
ÍÍN Z
)
ÍÍZ [
;
ÍÍ[ \
if
ÎÎ 
(
ÎÎ 
updatePortfolio
ÎÎ #
==
ÎÎ$ &
null
ÎÎ' +
||
ÎÎ, .
updatePortfolio
ÎÎ/ >
.
ÎÎ> ?
IdPortafolio
ÎÎ? K
<=
ÎÎL N
$num
ÎÎO P
)
ÎÎP Q
{
ÏÏ 
response
ÌÌ 
.
ÌÌ 
	IsExitoso
ÌÌ &
=
ÌÌ' (
false
ÌÌ) .
;
ÌÌ. /
response
ÓÓ 
.
ÓÓ 
Mensaje
ÓÓ $
=
ÓÓ% &
$str
ÓÓ' @
;
ÓÓ@ A
response
ÔÔ 
.
ÔÔ 

StatusCode
ÔÔ '
=
ÔÔ( )
HttpStatusCode
ÔÔ* 8
.
ÔÔ8 9
NotFound
ÔÔ9 A
;
ÔÔA B
return
 
response
 #
;
# $
}
ÒÒ 

Portafolio
ÙÙ 
model
ÙÙ  
=
ÙÙ! "
new
ÙÙ# &

Portafolio
ÙÙ' 1
{
ıı 
IdPortafolio
ˆˆ  
=
ˆˆ! "
updatePortfolio
ˆˆ# 2
.
ˆˆ2 3
IdPortafolio
ˆˆ3 ?
,
ˆˆ? @

ListaDatos
˜˜ 
=
˜˜  
request
˜˜! (
.
˜˜( )

ListaDatos
˜˜) 3
,
˜˜3 4
No_Envio
¯¯ 
=
¯¯ 
updatePortfolio
¯¯ .
.
¯¯. /
No_Envio
¯¯/ 7
,
¯¯7 8
}
˘˘ 
;
˘˘ 
response
˚˚ 
.
˚˚ 
	Resultado
˚˚ "
=
˚˚# $
await
˚˚% *"
_portfolioRepository
˚˚+ ?
.
˚˚? @
UpdateAsync
˚˚@ K
(
˚˚K L
model
˚˚L Q
)
˚˚Q R
;
˚˚R S
response
¸¸ 
.
¸¸ 
	IsExitoso
¸¸ "
=
¸¸# $
true
¸¸% )
;
¸¸) *
response
˝˝ 
.
˝˝ 
Mensaje
˝˝  
=
˝˝! "
$str
˝˝# D
;
˝˝D E
response
˛˛ 
.
˛˛ 

StatusCode
˛˛ #
=
˛˛$ %
HttpStatusCode
˛˛& 4
.
˛˛4 5
OK
˛˛5 7
;
˛˛7 8
}
ˇˇ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
response
ÇÇ 
.
ÇÇ 
	IsExitoso
ÇÇ "
=
ÇÇ# $
false
ÇÇ% *
;
ÇÇ* +
response
ÉÉ 
.
ÉÉ 
ErrorMessages
ÉÉ &
.
ÉÉ& '
Add
ÉÉ' *
(
ÉÉ* +$
ExceptionMessageHelper
ÉÉ+ A
.
ÉÉA B!
GetExceptionMessage
ÉÉB U
(
ÉÉU V
ex
ÉÉV X
)
ÉÉX Y
)
ÉÉY Z
;
ÉÉZ [
response
ÑÑ 
.
ÑÑ 

StatusCode
ÑÑ #
=
ÑÑ$ %
HttpStatusCode
ÑÑ& 4
.
ÑÑ4 5

BadRequest
ÑÑ5 ?
;
ÑÑ? @
}
ÖÖ 
return
áá 
response
áá 
;
áá 
}
àà 	
public
íí 
async
íí 
Task
íí 
<
íí 
ResponseDTO
íí %
>
íí% &
	ExcelLoad
íí' 0
(
íí0 1
	IFormFile
íí1 :
file
íí; ?
)
íí? @
{
ìì 	
var
ïï 
isValidFile
ïï 
=
ïï 
this
ïï "
.
ïï" #
ValidateFileExist
ïï# 4
(
ïï4 5
ref
ïï5 8
file
ïï9 =
)
ïï= >
;
ïï> ?
if
ññ 
(
ññ 
!
ññ 
isValidFile
ññ 
.
ññ 
	IsExitoso
ññ &
)
ññ& '
{
óó 
return
òò 
isValidFile
òò "
;
òò" #
}
ôô 
ResponseDTO
õõ 
response
õõ  
=
õõ! "
new
õõ# &
ResponseDTO
õõ' 2
(
õõ2 3
)
õõ3 4
;
õõ4 5
string
ùù 
resultReader
ùù 
=
ùù  !
string
ùù" (
.
ùù( )
Empty
ùù) .
;
ùù. /
string
ûû 
worksheetsName
ûû !
=
ûû" #
$str
ûû$ +
;
ûû+ ,
var
üü 
format
üü 
=
üü 
new
üü 
ExcelTextFormat
üü ,
(
üü, -
)
üü- .
;
üü. /
format
†† 
.
†† 
	Delimiter
†† 
=
†† 
$char
†† "
;
††" #
format
°° 
.
°° 
TextQualifier
°°  
=
°°! "
$char
°°# &
;
°°& '
ExcelPackage
¢¢ 
.
¢¢ 
LicenseContext
¢¢ '
=
¢¢( )
LicenseContext
¢¢* 8
.
¢¢8 9
NonCommercial
¢¢9 F
;
¢¢F G
string
§§ 
?
§§ !
fechaPosicionPivote
§§ '
=
§§( )
string
§§* 0
.
§§0 1
Empty
§§1 6
;
§§6 7
List
•• 
<
•• 

Portafolio
•• 
>
•• 
portafoliosList
•• ,
=
••- .
new
••/ 2
List
••3 7
<
••7 8

Portafolio
••8 B
>
••B C
(
••C D
)
••D E
!
••E F
;
••F G

Dictionary
ßß 
<
ßß 
int
ßß 
,
ßß 
string
ßß "
?
ßß" #
>
ßß# $
dictionaryDates
ßß% 4
=
ßß5 6
new
ßß7 :

Dictionary
ßß; E
<
ßßE F
int
ßßF I
,
ßßI J
string
ßßK Q
?
ßßQ R
>
ßßR S
(
ßßS T
)
ßßT U
!
ßßU V
;
ßßV W

Dictionary
®® 
<
®® 
int
®® 
,
®® 
string
®® "
?
®®" #
>
®®# $
dictionaryData
®®% 3
=
®®4 5
new
®®6 9

Dictionary
®®: D
<
®®D E
int
®®E H
,
®®H I
string
®®J P
?
®®P Q
>
®®Q R
(
®®R S
)
®®S T
!
®®T U
;
®®U V
try
™™ 
{
´´ 
var
≠≠ 
subPortafolioList
≠≠ %
=
≠≠& '
await
≠≠( -
this
≠≠. 2
.
≠≠2 3
GetSubPortfolios
≠≠3 C
(
≠≠C D
)
≠≠D E
;
≠≠E F
if
ÆÆ 
(
ÆÆ 
!
ÆÆ 
subPortafolioList
ÆÆ &
.
ÆÆ& '
Any
ÆÆ' *
(
ÆÆ* +
)
ÆÆ+ ,
)
ÆÆ, -
{
ØØ 
response
∞∞ 
.
∞∞ 
Mensaje
∞∞ $
=
∞∞% &
$str
∞∞' a
;
∞∞a b
response
±± 
.
±± 
	IsExitoso
±± &
=
±±' (
false
±±) .
;
±±. /
response
≤≤ 
.
≤≤ 

StatusCode
≤≤ '
=
≤≤( )
HttpStatusCode
≤≤* 8
.
≤≤8 9

BadRequest
≤≤9 C
;
≤≤C D
return
≥≥ 
response
≥≥ #
;
≥≥# $
}
¥¥ 
ExcelWorksheet
∂∂ 
?
∂∂ 
	worksheet
∂∂  )
=
∂∂* +
null
∂∂, 0
;
∂∂0 1
using
∑∑ 
(
∑∑ 
var
∑∑ 
reader
∑∑ !
=
∑∑" #
new
∑∑$ '
System
∑∑( .
.
∑∑. /
IO
∑∑/ 1
.
∑∑1 2
StreamReader
∑∑2 >
(
∑∑> ?
file
∑∑? C
.
∑∑C D
OpenReadStream
∑∑D R
(
∑∑R S
)
∑∑S T
)
∑∑T U
)
∑∑U V
using
∏∏ 
(
∏∏ 
ExcelPackage
∏∏ #
package
∏∏$ +
=
∏∏, -
new
∏∏. 1
ExcelPackage
∏∏2 >
(
∏∏> ?
)
∏∏? @
)
∏∏@ A
{
ππ 
resultReader
∫∫  
=
∫∫! "
await
∫∫# (
reader
∫∫) /
.
∫∫/ 0
ReadToEndAsync
∫∫0 >
(
∫∫> ?
)
∫∫? @
;
∫∫@ A
	worksheet
ªª 
=
ªª 
package
ªª  '
?
ªª' (
.
ªª( )
Workbook
ªª) 1
.
ªª1 2

Worksheets
ªª2 <
.
ªª< =
Add
ªª= @
(
ªª@ A
worksheetsName
ªªA O
)
ªªO P
;
ªªP Q
	worksheet
ºº 
=
ºº 
package
ºº  '
?
ºº' (
.
ºº( )
Workbook
ºº) 1
.
ºº1 2

Worksheets
ºº2 <
[
ºº< =
$num
ºº= >
]
ºº> ?
;
ºº? @
	worksheet
ΩΩ 
!
ΩΩ 
.
ΩΩ 
Cells
ΩΩ $
[
ΩΩ$ %
$str
ΩΩ% )
]
ΩΩ) *
.
ΩΩ* +
LoadFromText
ΩΩ+ 7
(
ΩΩ7 8
resultReader
ΩΩ8 D
,
ΩΩD E
format
ΩΩF L
)
ΩΩL M
;
ΩΩM N!
fechaPosicionPivote
¿¿ '
=
¿¿( )
	worksheet
¿¿* 3
.
¿¿3 4
Cells
¿¿4 9
[
¿¿9 :
$num
¿¿: ;
,
¿¿; <
$num
¿¿= >
]
¿¿> ?
.
¿¿? @
Value
¿¿@ E
?
¿¿E F
.
¿¿F G
ToString
¿¿G O
(
¿¿O P
)
¿¿P Q
?
¿¿Q R
.
¿¿R S
Trim
¿¿S W
(
¿¿W X
)
¿¿X Y
;
¿¿Y Z
if
¡¡ 
(
¡¡ 
string
¡¡ 
.
¡¡ 
IsNullOrEmpty
¡¡ ,
(
¡¡, -!
fechaPosicionPivote
¡¡- @
)
¡¡@ A
)
¡¡A B
{
¬¬ 
response
√√  
.
√√  !
Mensaje
√√! (
=
√√) *
$str
√√+ d
;
√√d e
response
ƒƒ  
.
ƒƒ  !
	IsExitoso
ƒƒ! *
=
ƒƒ+ ,
false
ƒƒ- 2
;
ƒƒ2 3
response
≈≈  
.
≈≈  !

StatusCode
≈≈! +
=
≈≈, -
HttpStatusCode
≈≈. <
.
≈≈< =

BadRequest
≈≈= G
;
≈≈G H
return
∆∆ 
response
∆∆ '
;
∆∆' (
}
«« 
dictionaryDates
   #
=
  $ %
this
  & *
.
  * +
GetDateList
  + 6
(
  6 7
	worksheet
  7 @
)
  @ A
;
  A B
if
ÀÀ 
(
ÀÀ 
!
ÀÀ 
dictionaryDates
ÀÀ (
.
ÀÀ( )
Any
ÀÀ) ,
(
ÀÀ, -
)
ÀÀ- .
&&
ÀÀ/ 1
dictionaryDates
ÀÀ2 A
.
ÀÀA B
Count
ÀÀB G
==
ÀÀH J
$num
ÀÀK L
)
ÀÀL M
{
ÃÃ 
response
ÕÕ  
.
ÕÕ  !
Mensaje
ÕÕ! (
=
ÕÕ) *
$str
ÕÕ+ `
;
ÕÕ` a
response
ŒŒ  
.
ŒŒ  !
	IsExitoso
ŒŒ! *
=
ŒŒ+ ,
false
ŒŒ- 2
;
ŒŒ2 3
response
œœ  
.
œœ  !

StatusCode
œœ! +
=
œœ, -
HttpStatusCode
œœ. <
.
œœ< =

BadRequest
œœ= G
;
œœG H
return
–– 
response
–– '
;
––' (
}
—— 

Portafolio
”” 
newPortafolio
”” ,
=
””- .
new
””/ 2

Portafolio
””3 =
(
””= >
)
””> ?
!
””? @
;
””@ A
int
‘‘ 
colCount
‘‘  
=
‘‘! "
	worksheet
‘‘# ,
.
‘‘, -
	Dimension
‘‘- 6
.
‘‘6 7
End
‘‘7 :
.
‘‘: ;
Column
‘‘; A
;
‘‘A B
int
’’ 
rowCount
’’  
=
’’! "
	worksheet
’’# ,
.
’’, -
	Dimension
’’- 6
.
’’6 7
End
’’7 :
.
’’: ;
Row
’’; >
;
’’> ?
for
ÿÿ 
(
ÿÿ 
int
ÿÿ 
row
ÿÿ  
=
ÿÿ! "
$num
ÿÿ# $
;
ÿÿ$ %
row
ÿÿ& )
<=
ÿÿ* ,
rowCount
ÿÿ- 5
;
ÿÿ5 6
row
ÿÿ7 :
++
ÿÿ: <
)
ÿÿ< =
{
ŸŸ 
dictionaryData
⁄⁄ &
=
⁄⁄' (
new
⁄⁄) ,

Dictionary
⁄⁄- 7
<
⁄⁄7 8
int
⁄⁄8 ;
,
⁄⁄; <
string
⁄⁄= C
?
⁄⁄C D
>
⁄⁄D E
(
⁄⁄E F
)
⁄⁄F G
!
⁄⁄G H
;
⁄⁄H I
newPortafolio
€€ %
=
€€& '
new
€€( +

Portafolio
€€, 6
{
‹‹ 

F_Posicion
›› &
=
››' (!
fechaPosicionPivote
››) <
,
››< =
NombrePortafolio
ﬁﬁ ,
=
ﬁﬁ- .
$str
ﬁﬁ/ 6
,
ﬁﬁ6 7
No_Envio
ﬂﬂ $
=
ﬂﬂ% &
$num
ﬂﬂ' (
,
ﬂﬂ( )
FechaCreacion
‡‡ )
=
‡‡* +
DateTime
‡‡, 4
.
‡‡4 5
Now
‡‡5 8
,
‡‡8 9
FechaModificacion
·· -
=
··. /
DateTime
··0 8
.
··8 9
Now
··9 <
}
‚‚ 
;
‚‚ 
for
‰‰ 
(
‰‰ 
int
‰‰  
col
‰‰! $
=
‰‰% &
$num
‰‰' (
;
‰‰( )
col
‰‰* -
<=
‰‰. 0
colCount
‰‰1 9
;
‰‰9 :
col
‰‰; >
++
‰‰> @
)
‰‰@ A
{
ÂÂ 
string
ÊÊ "
?
ÊÊ" #
currentCellValue
ÊÊ$ 4
=
ÊÊ5 6
	worksheet
ÊÊ7 @
.
ÊÊ@ A
Cells
ÊÊA F
[
ÊÊF G
row
ÊÊG J
,
ÊÊJ K
col
ÊÊL O
]
ÊÊO P
.
ÊÊP Q
Value
ÊÊQ V
?
ÊÊV W
.
ÊÊW X
ToString
ÊÊX `
(
ÊÊ` a
)
ÊÊa b
?
ÊÊb c
.
ÊÊc d
Trim
ÊÊd h
(
ÊÊh i
)
ÊÊi j
;
ÊÊj k
if
ÁÁ 
(
ÁÁ  
!
ÁÁ  !
string
ÁÁ! '
.
ÁÁ' (
IsNullOrEmpty
ÁÁ( 5
(
ÁÁ5 6
currentCellValue
ÁÁ6 F
)
ÁÁF G
)
ÁÁG H
{
ËË 
if
ÍÍ  "
(
ÍÍ# $
col
ÍÍ$ '
==
ÍÍ( *
$num
ÍÍ+ ,
)
ÍÍ, -
{
ÎÎ  !
string
ÏÏ$ *
?
ÏÏ* +
subPortfolio
ÏÏ, 8
=
ÏÏ9 :
currentCellValue
ÏÏ; K
.
ÏÏK L
ToUpper
ÏÏL S
(
ÏÏS T
)
ÏÏT U
;
ÏÏU V
newPortafolio
ÓÓ$ 1
.
ÓÓ1 2
SubPortafolioId
ÓÓ2 A
=
ÓÓB C
this
ÓÓD H
.
ÓÓH I"
GetSubPortfolioValue
ÓÓI ]
(
ÓÓ] ^
subPortafolioList
ÓÓ^ o
,
ÓÓo p
subPortfolio
ÓÓq }
)
ÓÓ} ~
;
ÓÓ~ 
if
$ &
(
' (
newPortafolio
( 5
.
5 6
SubPortafolioId
6 E
==
F H
$num
I J
)
J K
{
ÒÒ$ %
response
ÚÚ( 0
.
ÚÚ0 1
ErrorMessages
ÚÚ1 >
.
ÚÚ> ?
Add
ÚÚ? B
(
ÚÚB C
$"
ÚÚC E
$str
ÚÚE n
{
ÚÚn o
Environment
ÚÚo z
.
ÚÚz {
NewLineÚÚ{ Ç
}ÚÚÇ É
$strÚÚÉ ∂
{ÚÚ∂ ∑
rowÚÚ∑ ∫
}ÚÚ∫ ª
$strÚÚª Ω
{ÚÚΩ æ
colÚÚæ ¡
}ÚÚ¡ ¬
$strÚÚ¬ »
{ÚÚ» …
subPortfolioÚÚ… ’
}ÚÚ’ ÷
$strÚÚ÷ ÿ
"ÚÚÿ Ÿ
)ÚÚŸ ⁄
;ÚÚ⁄ €
}
ÛÛ$ %
}
ÙÙ  !
if
ˆˆ  "
(
ˆˆ# $
col
ˆˆ$ '
>
ˆˆ( )
$num
ˆˆ* +
&&
ˆˆ, .
subPortafolioList
ˆˆ/ @
.
ˆˆ@ A
Any
ˆˆA D
(
ˆˆD E
x
ˆˆE F
=>
ˆˆG I
x
ˆˆJ K
.
ˆˆK L
SubPortafolioId
ˆˆL [
==
ˆˆ\ ^
newPortafolio
ˆˆ_ l
.
ˆˆl m
SubPortafolioId
ˆˆm |
)
ˆˆ| }
)
ˆˆ} ~
{
˜˜  !
dictionaryData
¯¯$ 2
.
¯¯2 3
Add
¯¯3 6
(
¯¯6 7
col
¯¯7 :
,
¯¯: ;
currentCellValue
¯¯< L
)
¯¯L M
;
¯¯M N
}
˘˘  !
}
˙˙ 
}
˚˚ 
if
˝˝ 
(
˝˝ 
newPortafolio
˝˝ )
!=
˝˝* ,
null
˝˝- 1
&&
˝˝2 4
newPortafolio
˝˝5 B
.
˝˝B C
SubPortafolioId
˝˝C R
>
˝˝S T
$num
˝˝U V
)
˝˝V W
{
˛˛ 
bool
ÅÅ  
isKeysTheSame
ÅÅ! .
=
ÅÅ/ 0
dictionaryDates
ÅÅ1 @
.
ÅÅ@ A
Count
ÅÅA F
==
ÅÅG I
dictionaryData
ÅÅJ X
.
ÅÅX Y
Count
ÅÅY ^
&&
ÅÅ_ a
!
ÅÅb c
dictionaryDates
ÅÅc r
.
ÅÅr s
Keys
ÅÅs w
.
ÅÅw x
Except
ÅÅx ~
(
ÅÅ~ 
dictionaryDataÅÅ ç
.ÅÅç é
KeysÅÅé í
)ÅÅí ì
.ÅÅì î
AnyÅÅî ó
(ÅÅó ò
)ÅÅò ô
;ÅÅô ö
if
ÇÇ 
(
ÇÇ  
!
ÇÇ  !
isKeysTheSame
ÇÇ! .
)
ÇÇ. /
{
ÉÉ 
response
ÑÑ  (
.
ÑÑ( )
Mensaje
ÑÑ) 0
=
ÑÑ1 2
$str
ÑÑ3 d
;
ÑÑd e
response
ÖÖ  (
.
ÖÖ( )
ErrorMessages
ÖÖ) 6
.
ÖÖ6 7
Add
ÖÖ7 :
(
ÖÖ: ;
$"
ÖÖ; =
$str
ÖÖ= C
{
ÖÖC D
row
ÖÖD G
}
ÖÖG H
$strÖÖH Ä
"ÖÖÄ Å
)ÖÖÅ Ç
;ÖÖÇ É
response
ÜÜ  (
.
ÜÜ( )
	IsExitoso
ÜÜ) 2
=
ÜÜ3 4
false
ÜÜ5 :
;
ÜÜ: ;
response
áá  (
.
áá( )

StatusCode
áá) 3
=
áá4 5
HttpStatusCode
áá6 D
.
ááD E

BadRequest
ááE O
;
ááO P
return
àà  &
response
àà' /
;
àà/ 0
}
ââ 
var
ãã 
datos
ãã  %
=
ãã& '
(
ãã( )
from
ãã) -
f
ãã. /
in
ãã0 2
dictionaryDates
ãã3 B
join
åå) -
d
åå. /
in
åå0 2
dictionaryData
åå3 A
on
ååB D
f
ååE F
.
ååF G
Key
ååG J
equals
ååK Q
d
ååR S
.
ååS T
Key
ååT W
select
çç) /
new
çç0 3
{
çç4 5
Fecha
çç6 ;
=
çç< =
f
çç> ?
.
çç? @
Value
çç@ E
,
ççE F
Valor
ççG L
=
ççM N
d
ççO P
.
ççP Q
Value
ççQ V
}
ççW X
)
ççX Y
.
ççY Z
ToList
ççZ `
(
çç` a
)
çça b
;
ççb c
if
èè 
(
èè  
datos
èè  %
!=
èè& (
null
èè) -
)
èè- .
{
êê 
newPortafolio
ëë  -
.
ëë- .

ListaDatos
ëë. 8
=
ëë9 :
JsonSerializer
ëë; I
.
ëëI J
	Serialize
ëëJ S
(
ëëS T
datos
ëëT Y
)
ëëY Z
;
ëëZ [
}
íí 
portafoliosList
ïï +
.
ïï+ ,
Add
ïï, /
(
ïï/ 0
newPortafolio
ïï0 =
)
ïï= >
;
ïï> ?
}
ññ 
}
óó 
var
ôô 
result
ôô 
=
ôô  
await
ôô! &"
_portfolioRepository
ôô' ;
.
ôô; < 
SavePortfoliosList
ôô< N
(
ôôN O
portafoliosList
ôôO ^
)
ôô^ _
;
ôô_ `
response
öö 
.
öö 
ErrorMessages
öö *
.
öö* +
AddRange
öö+ 3
(
öö3 4
result
öö4 :
)
öö: ;
;
öö; <
}
õõ 
if
ûû 
(
ûû 
this
ûû 
.
ûû 
procedencia
ûû $
==
ûû% '

originList
ûû( 2
[
ûû2 3
$num
ûû3 4
]
ûû4 5
!
ûû5 6
)
ûû6 7
{
üü 
var
°° 
saved
°° 
=
°° 
await
°°  %
this
°°& *
.
°°* +
SaveBackUpServer
°°+ ;
(
°°; <
)
°°< =
;
°°= >
if
¢¢ 
(
¢¢ 
!
¢¢ 
saved
¢¢ 
.
¢¢ 
	IsExitoso
¢¢ (
)
¢¢( )
{
££ 
response
§§  
.
§§  !
ErrorMessages
§§! .
.
§§. /
Add
§§/ 2
(
§§2 3
saved
§§3 8
.
§§8 9
Mensaje
§§9 @
!
§§@ A
)
§§A B
;
§§B C
}
•• 
}
¶¶ 
else
ßß 
{
ßß 
var
©© 
saved
©© 
=
©© 
await
©©  %
this
©©& *
.
©©* + 
SaveBackUpEndPoint
©©+ =
(
©©= >
file
©©> B
)
©©B C
;
©©C D
if
™™ 
(
™™ 
!
™™ 
saved
™™ 
.
™™ 
	IsExitoso
™™ (
)
™™( )
{
´´ 
response
¨¨  
.
¨¨  !
ErrorMessages
¨¨! .
.
¨¨. /
Add
¨¨/ 2
(
¨¨2 3
saved
¨¨3 8
.
¨¨8 9
Mensaje
¨¨9 @
!
¨¨@ A
)
¨¨A B
;
¨¨B C
}
≠≠ 
}
ÆÆ 
if
±± 
(
±± 
this
±± 
.
±± 
procedencia
±± $
==
±±% '

originList
±±( 2
[
±±2 3
$num
±±3 4
]
±±4 5
!
±±5 6
)
±±6 7
{
≤≤ 
var
≥≥ 
moved
≥≥ 
=
≥≥ 
await
≥≥  %
this
≥≥& *
.
≥≥* +$
MoveFileToServerFolder
≥≥+ A
(
≥≥A B
)
≥≥B C
;
≥≥C D
if
¥¥ 
(
¥¥ 
!
¥¥ 
moved
¥¥ 
.
¥¥ 
	IsExitoso
¥¥ (
)
¥¥( )
{
µµ 
response
∂∂  
.
∂∂  !
ErrorMessages
∂∂! .
.
∂∂. /
Add
∂∂/ 2
(
∂∂2 3
moved
∂∂3 8
.
∂∂8 9
Mensaje
∂∂9 @
!
∂∂@ A
)
∂∂A B
;
∂∂B C
}
∑∑ 
}
∏∏ 
response
∫∫ 
.
∫∫ 
	IsExitoso
∫∫ "
=
∫∫# $
true
∫∫% )
;
∫∫) *
response
ªª 
.
ªª 
Mensaje
ªª  
=
ªª! "
$str
ªª# A
;
ªªA B
response
ºº 
.
ºº 
	Resultado
ºº "
=
ºº# $
true
ºº% )
;
ºº) *
response
ΩΩ 
.
ΩΩ 

StatusCode
ΩΩ #
=
ΩΩ$ %
HttpStatusCode
ΩΩ& 4
.
ΩΩ4 5
OK
ΩΩ5 7
;
ΩΩ7 8
}
ææ 
catch
øø 
(
øø "
KeyNotFoundException
øø '
ke
øø( *
)
øø* +
{
¿¿ 
response
¡¡ 
.
¡¡ 
	IsExitoso
¡¡ "
=
¡¡# $
false
¡¡% *
;
¡¡* +
response
¬¬ 
.
¬¬ 
ErrorMessages
¬¬ &
.
¬¬& '
Add
¬¬' *
(
¬¬* +
$"
¬¬+ -
$str
¬¬- >
{
¬¬> ?$
ExceptionMessageHelper
¬¬? U
.
¬¬U V!
GetExceptionMessage
¬¬V i
(
¬¬i j
ke
¬¬j l
)
¬¬l m
}
¬¬m n
"
¬¬n o
)
¬¬o p
;
¬¬p q
response
√√ 
.
√√ 

StatusCode
√√ #
=
√√$ %
HttpStatusCode
√√& 4
.
√√4 5

BadRequest
√√5 ?
;
√√? @
response
ƒƒ 
.
ƒƒ 
	Resultado
ƒƒ "
=
ƒƒ# $
false
ƒƒ% *
;
ƒƒ* +
return
≈≈ 
response
≈≈ 
;
≈≈  
}
∆∆ 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
»» 
response
…… 
.
…… 
	IsExitoso
…… "
=
……# $
false
……% *
;
……* +
response
   
.
   
ErrorMessages
   &
.
  & '
Add
  ' *
(
  * +$
ExceptionMessageHelper
  + A
.
  A B!
GetExceptionMessage
  B U
(
  U V
ex
  V X
)
  X Y
)
  Y Z
;
  Z [
response
ÀÀ 
.
ÀÀ 

StatusCode
ÀÀ #
=
ÀÀ$ %
HttpStatusCode
ÀÀ& 4
.
ÀÀ4 5

BadRequest
ÀÀ5 ?
;
ÀÀ? @
response
ÃÃ 
.
ÃÃ 
	Resultado
ÃÃ "
=
ÃÃ# $
false
ÃÃ% *
;
ÃÃ* +
return
ÕÕ 
response
ÕÕ 
;
ÕÕ  
}
ŒŒ 
return
–– 
response
–– 
;
–– 
}
—— 	
private
ÿÿ 

Dictionary
ÿÿ 
<
ÿÿ 
int
ÿÿ 
,
ÿÿ 
string
ÿÿ  &
?
ÿÿ& '
>
ÿÿ' (
GetDateList
ÿÿ) 4
(
ÿÿ4 5
ExcelWorksheet
ÿÿ5 C
	worksheet
ÿÿD M
)
ÿÿM N
{
ŸŸ 	

Dictionary
⁄⁄ 
<
⁄⁄ 
int
⁄⁄ 
,
⁄⁄ 
string
⁄⁄ "
?
⁄⁄" #
>
⁄⁄# $
dateList
⁄⁄% -
=
⁄⁄. /
new
⁄⁄0 3

Dictionary
⁄⁄4 >
<
⁄⁄> ?
int
⁄⁄? B
,
⁄⁄B C
string
⁄⁄D J
?
⁄⁄J K
>
⁄⁄K L
(
⁄⁄L M
)
⁄⁄M N
;
⁄⁄N O
int
€€ 
colCount
€€ 
=
€€ 
	worksheet
€€ $
.
€€$ %
	Dimension
€€% .
.
€€. /
End
€€/ 2
.
€€2 3
Column
€€3 9
;
€€9 :
for
›› 
(
›› 
int
›› 
col
›› 
=
›› 
$num
›› 
;
›› 
col
›› !
<=
››" $
colCount
››% -
;
››- .
col
››/ 2
++
››2 4
)
››4 5
{
ﬁﬁ 
string
ﬂﬂ 
?
ﬂﬂ 
currentCellValue
ﬂﬂ (
=
ﬂﬂ) *
	worksheet
ﬂﬂ+ 4
.
ﬂﬂ4 5
Cells
ﬂﬂ5 :
[
ﬂﬂ: ;
rowDate
ﬂﬂ; B
,
ﬂﬂB C
col
ﬂﬂD G
]
ﬂﬂG H
.
ﬂﬂH I
Value
ﬂﬂI N
?
ﬂﬂN O
.
ﬂﬂO P
ToString
ﬂﬂP X
(
ﬂﬂX Y
)
ﬂﬂY Z
?
ﬂﬂZ [
.
ﬂﬂ[ \
Trim
ﬂﬂ\ `
(
ﬂﬂ` a
)
ﬂﬂa b
;
ﬂﬂb c
if
‡‡ 
(
‡‡ 
!
‡‡ 
string
‡‡ 
.
‡‡ 
IsNullOrEmpty
‡‡ )
(
‡‡) *
currentCellValue
‡‡* :
)
‡‡: ;
)
‡‡; <
{
·· 
dateList
‚‚ 
.
‚‚ 
Add
‚‚  
(
‚‚  !
col
‚‚! $
,
‚‚$ %
currentCellValue
‚‚& 6
)
‚‚6 7
;
‚‚7 8
}
„„ 
}
‰‰ 
return
ÊÊ 
dateList
ÊÊ 
;
ÊÊ 
}
ÁÁ 	
private
ÌÌ 
async
ÌÌ 
Task
ÌÌ 
<
ÌÌ 
IEnumerable
ÌÌ &
<
ÌÌ& '
SubPortafolios
ÌÌ' 5
>
ÌÌ5 6
>
ÌÌ6 7
GetSubPortfolios
ÌÌ8 H
(
ÌÌH I
)
ÌÌI J
{
ÓÓ 	
var
ÔÔ 
response
ÔÔ 
=
ÔÔ 
await
ÔÔ  "
_portfolioRepository
ÔÔ! 5
.
ÔÔ5 6&
GetAllSubPortfoliosAsync
ÔÔ6 N
(
ÔÔN O
)
ÔÔO P
;
ÔÔP Q
return
 
response
 
;
 
}
ÒÒ 	
private
˘˘ 
int
˘˘ "
GetSubPortfolioValue
˘˘ (
(
˘˘( )
IEnumerable
˘˘) 4
<
˘˘4 5
SubPortafolios
˘˘5 C
>
˘˘C D
subPortfolioList
˘˘E U
,
˘˘U V
string
˘˘W ]
?
˘˘] ^
value
˘˘_ d
)
˘˘d e
{
˙˙ 	
int
˚˚ 
id
˚˚ 
=
˚˚ 
$num
˚˚ 
;
˚˚ 
if
˝˝ 
(
˝˝ 
!
˝˝ 
string
˝˝ 
.
˝˝ 
IsNullOrEmpty
˝˝ %
(
˝˝% &
value
˝˝& +
)
˝˝+ ,
)
˝˝, -
{
˛˛ 
id
ˇˇ 
=
ˇˇ 
subPortfolioList
ˇˇ %
.
ˇˇ% &
Where
ˇˇ& +
(
ˇˇ+ ,
x
ˇˇ, -
=>
ˇˇ. 0
x
ˇˇ1 2
.
ˇˇ2 3
Descripcion
ˇˇ3 >
?
ˇˇ> ?
.
ˇˇ? @
Trim
ˇˇ@ D
(
ˇˇD E
)
ˇˇE F
.
ˇˇF G
ToUpper
ˇˇG N
(
ˇˇN O
)
ˇˇO P
==
ˇˇQ S
value
ˇˇT Y
.
ˇˇY Z
Trim
ˇˇZ ^
(
ˇˇ^ _
)
ˇˇ_ `
.
ˇˇ` a
ToUpper
ˇˇa h
(
ˇˇh i
)
ˇˇi j
)
ˇˇj k
.
ˇˇk l
Select
ˇˇl r
(
ˇˇr s
y
ˇˇs t
=>
ˇˇu w
y
ˇˇx y
.
ˇˇy z
SubPortafolioIdˇˇz â
)ˇˇâ ä
.ˇˇä ã
FirstOrDefaultˇˇã ô
(ˇˇô ö
)ˇˇö õ
;ˇˇõ ú
}
ÄÄ 
return
ÇÇ 
id
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
private
ää 
ResponseDTO
ää 
ValidateFileExist
ää -
(
ää- .
ref
ää. 1
	IFormFile
ää2 ;
file
ää< @
)
ää@ A
{
ãã 	
ResponseDTO
åå 
response
åå  
=
åå! "
new
åå# &
ResponseDTO
åå' 2
{
åå3 4
	IsExitoso
åå5 >
=
åå? @
false
ååA F
}
ååG H
;
ååH I
this
çç 
.
çç 
procedencia
çç 
=
çç 

originList
çç )
[
çç) *
$num
çç* +
]
çç+ ,
!
çç, -
;
çç- .
if
êê 
(
êê 
file
êê 
!=
êê 
null
êê 
&&
êê 
file
êê  $
!
êê$ %
.
êê% &
Length
êê& ,
>
êê- .
$num
êê/ 0
)
êê0 1
{
ëë 
response
íí 
.
íí 
	IsExitoso
íí "
=
íí# $
true
íí% )
;
íí) *
response
ìì 
.
ìì 

StatusCode
ìì #
=
ìì$ %
HttpStatusCode
ìì& 4
.
ìì4 5
OK
ìì5 7
;
ìì7 8
return
îî 
response
îî 
;
îî  
}
ïï 
if
óó 
(
óó 
file
óó 
==
óó 
null
óó 
||
óó 
file
óó  $
.
óó$ %
Length
óó% +
==
óó, .
$num
óó/ 0
)
óó0 1
{
òò 
string
öö &
pathServerFolderComplete
öö /
=
öö0 1
@$"
öö2 5
{
öö5 6
this
öö6 :
.
öö: ;%
uploadServerFileUrlPath
öö; R
}
ööR S
{
ööS T
this
ööT X
.
ööX Y&
uploadServerFolderSource
ööY q
}
ööq r
{
öör s
this
öös w
.
ööw x
fileNameööx Ä
}ööÄ Å
"ööÅ Ç
;ööÇ É
if
ùù 
(
ùù 
File
ùù 
.
ùù 
Exists
ùù 
(
ùù  &
pathServerFolderComplete
ùù  8
)
ùù8 9
)
ùù9 :
{
ûû 
if
üü 
(
üü &
pathServerFolderComplete
üü 0
.
üü0 1
ToLower
üü1 8
(
üü8 9
)
üü9 :
.
üü: ;
EndsWith
üü; C
(
üüC D
$str
üüD J
)
üüJ K
)
üüK L
{
†† 
var
¢¢ 
provider
¢¢ $
=
¢¢% &
new
¢¢' *.
 FileExtensionContentTypeProvider
¢¢+ K
(
¢¢K L
)
¢¢L M
;
¢¢M N
string
££ 
tmpContentType
££ -
=
££. /
string
££0 6
.
££6 7
Empty
££7 <
;
££< =
if
§§ 
(
§§ 
!
§§ 
provider
§§ %
.
§§% &
TryGetContentType
§§& 7
(
§§7 8
fileName
§§8 @
!
§§@ A
,
§§A B
out
§§C F
tmpContentType
§§G U
!
§§U V
)
§§V W
)
§§W X
{
•• 
tmpContentType
¶¶ *
=
¶¶+ ,
$str
¶¶- 3
;
¶¶3 4
}
ßß 
if
®® 
(
®® 
contentType
®® '
!=
®®( *
tmpContentType
®®+ 9
)
®®9 :
{
©© 
response
™™ $
.
™™$ %
Mensaje
™™% ,
=
™™- .
$str
™™/ u
;
™™u v
response
´´ $
.
´´$ %

StatusCode
´´% /
=
´´0 1
HttpStatusCode
´´2 @
.
´´@ A

BadRequest
´´A K
;
´´K L
return
¨¨ "
response
¨¨# +
;
¨¨+ ,
}
≠≠ 
string
∞∞ 
name
∞∞ #
=
∞∞$ %
Path
∞∞& *
.
∞∞* +)
GetFileNameWithoutExtension
∞∞+ F
(
∞∞F G&
pathServerFolderComplete
∞∞G _
)
∞∞_ `
;
∞∞` a
string
±± 
fileContent
±± *
=
±±+ ,
File
±±- 1
.
±±1 2
ReadAllText
±±2 =
(
±±= >&
pathServerFolderComplete
±±> V
)
±±V W
;
±±W X
byte
≤≤ 
[
≤≤ 
]
≤≤ 
	byteArray
≤≤ (
=
≤≤) *
Encoding
≤≤+ 3
.
≤≤3 4
UTF8
≤≤4 8
.
≤≤8 9
GetBytes
≤≤9 A
(
≤≤A B
fileContent
≤≤B M
)
≤≤M N
;
≤≤N O
var
≥≥ 
memoryStream
≥≥ (
=
≥≥) *
new
≥≥+ .
MemoryStream
≥≥/ ;
(
≥≥; <
	byteArray
≥≥< E
)
≥≥E F
;
≥≥F G
	IFormFile
µµ !
archivoForm
µµ" -
=
µµ. /
new
µµ0 3
FormFile
µµ4 <
(
µµ< =
memoryStream
µµ= I
,
µµI J
$num
µµK L
,
µµL M
	byteArray
µµN W
.
µµW X
Length
µµX ^
,
µµ^ _
name
µµ` d
,
µµd e
fileName
µµf n
!
µµn o
)
µµo p
;
µµp q
file
∂∂ 
=
∂∂ 
archivoForm
∂∂ *
;
∂∂* +
response
∑∑  
.
∑∑  !
	IsExitoso
∑∑! *
=
∑∑+ ,
true
∑∑- 1
;
∑∑1 2
response
∏∏  
.
∏∏  !

StatusCode
∏∏! +
=
∏∏, -
HttpStatusCode
∏∏. <
.
∏∏< =
OK
∏∏= ?
;
∏∏? @
this
ππ 
.
ππ 
procedencia
ππ (
=
ππ) *

originList
ππ+ 5
[
ππ5 6
$num
ππ6 7
]
ππ7 8
!
ππ8 9
;
ππ9 :
}
∫∫ 
else
ªª 
{
ºº 
response
ΩΩ  
.
ΩΩ  !
Mensaje
ΩΩ! (
=
ΩΩ) *
$str
ΩΩ+ 8
+
ΩΩ9 :&
pathServerFolderComplete
ΩΩ; S
+
ΩΩT U
$str
ΩΩV g
;
ΩΩg h
response
ææ  
.
ææ  !

StatusCode
ææ! +
=
ææ, -
HttpStatusCode
ææ. <
.
ææ< =

BadRequest
ææ= G
;
ææG H
}
øø 
}
¿¿ 
else
¡¡ 
{
¬¬ 
response
√√ 
.
√√ 
Mensaje
√√ $
=
√√% &
$str
√√' 4
+
√√5 6&
pathServerFolderComplete
√√7 O
+
√√P Q
$str
√√R _
;
√√_ `
response
ƒƒ 
.
ƒƒ 

StatusCode
ƒƒ '
=
ƒƒ( )
HttpStatusCode
ƒƒ* 8
.
ƒƒ8 9

BadRequest
ƒƒ9 C
;
ƒƒC D
}
≈≈ 
}
∆∆ 
if
…… 
(
…… 
file
…… 
==
…… 
null
…… 
||
…… 
file
……  $
.
……$ %
Length
……% +
==
……, .
$num
……/ 0
)
……0 1
{
   
response
ÀÀ 
.
ÀÀ 
Mensaje
ÀÀ  
=
ÀÀ! "
$str
ÀÀ# B
;
ÀÀB C
response
ÃÃ 
.
ÃÃ 

StatusCode
ÃÃ #
=
ÃÃ$ %
HttpStatusCode
ÃÃ& 4
.
ÃÃ4 5

BadRequest
ÃÃ5 ?
;
ÃÃ? @
}
ÕÕ 
return
œœ 
response
œœ 
;
œœ 
}
–– 	
private
÷÷ 
async
÷÷ 
Task
÷÷ 
<
÷÷ 
ResponseDTO
÷÷ &
>
÷÷& '$
MoveFileToServerFolder
÷÷( >
(
÷÷> ?
)
÷÷? @
{
◊◊ 	
ResponseDTO
ÿÿ 
response
ÿÿ  
=
ÿÿ! "
new
ÿÿ# &
ResponseDTO
ÿÿ' 2
{
ÿÿ3 4
	IsExitoso
ÿÿ5 >
=
ÿÿ? @
false
ÿÿA F
}
ÿÿG H
;
ÿÿH I
var
⁄⁄ 
date
⁄⁄ 
=
⁄⁄ 
DateTime
⁄⁄ 
.
⁄⁄  
Now
⁄⁄  #
.
⁄⁄# $
ToString
⁄⁄$ ,
(
⁄⁄, -
$str
⁄⁄- 0
)
⁄⁄0 1
.
⁄⁄1 2
Replace
⁄⁄2 9
(
⁄⁄9 :
$str
⁄⁄: =
,
⁄⁄= >
$str
⁄⁄? B
)
⁄⁄B C
;
⁄⁄C D
string
€€ 
name
€€ 
=
€€ 
Path
€€ 
.
€€ )
GetFileNameWithoutExtension
€€ :
(
€€: ;
this
€€; ?
.
€€? @
fileName
€€@ H
!
€€H I
)
€€I J
;
€€J K
string
‹‹ 
	extension
‹‹ 
=
‹‹ 
Path
‹‹ #
.
‹‹# $
GetExtension
‹‹$ 0
(
‹‹0 1
fileName
‹‹1 9
!
‹‹9 :
)
‹‹: ;
;
‹‹; <
string
ﬁﬁ 

sourcePath
ﬁﬁ 
=
ﬁﬁ 
@$"
ﬁﬁ  #
{
ﬁﬁ# $
this
ﬁﬁ$ (
.
ﬁﬁ( )%
uploadServerFileUrlPath
ﬁﬁ) @
}
ﬁﬁ@ A
{
ﬁﬁA B
this
ﬁﬁB F
.
ﬁﬁF G&
uploadServerFolderSource
ﬁﬁG _
}
ﬁﬁ_ `
{
ﬁﬁ` a
this
ﬁﬁa e
.
ﬁﬁe f
fileName
ﬁﬁf n
}
ﬁﬁn o
"
ﬁﬁo p
;
ﬁﬁp q
string
ﬂﬂ 
destinationPath
ﬂﬂ "
=
ﬂﬂ# $
@$"
ﬂﬂ% (
{
ﬂﬂ( )
this
ﬂﬂ) -
.
ﬂﬂ- .'
downloadServerFileUrlPath
ﬂﬂ. G
}
ﬂﬂG H
{
ﬂﬂH I
this
ﬂﬂI M
.
ﬂﬂM N-
downloadServerFolderDestination
ﬂﬂN m
}
ﬂﬂm n
{
ﬂﬂn o
name
ﬂﬂo s
}
ﬂﬂs t
$str
ﬂﬂt v
{
ﬂﬂv w
date
ﬂﬂw {
}
ﬂﬂ{ |
$str
ﬂﬂ| }
{
ﬂﬂ} ~
	extensionﬂﬂ~ á
}ﬂﬂá à
"ﬂﬂà â
;ﬂﬂâ ä
try
·· 
{
‚‚ 
if
‰‰ 
(
‰‰ 
System
‰‰ 
.
‰‰ 
IO
‰‰ 
.
‰‰ 
File
‰‰ "
.
‰‰" #
Exists
‰‰# )
(
‰‰) *

sourcePath
‰‰* 4
)
‰‰4 5
)
‰‰5 6
{
ÂÂ 
File
ÊÊ 
.
ÊÊ 
Move
ÊÊ 
(
ÊÊ 

sourcePath
ÊÊ (
,
ÊÊ( )
destinationPath
ÊÊ* 9
)
ÊÊ9 :
;
ÊÊ: ;
response
ÁÁ 
.
ÁÁ 
	IsExitoso
ÁÁ &
=
ÁÁ' (
true
ÁÁ) -
;
ÁÁ- .
}
ËË 
else
ÈÈ 
{
ÍÍ 
response
ÎÎ 
.
ÎÎ 
Mensaje
ÎÎ $
=
ÎÎ% &
$str
ÎÎ' 4
+
ÎÎ5 6

sourcePath
ÎÎ7 A
+
ÎÎB C
$str
ÎÎD Q
;
ÎÎQ R
response
ÏÏ 
.
ÏÏ 

StatusCode
ÏÏ '
=
ÏÏ( )
System
ÏÏ* 0
.
ÏÏ0 1
Net
ÏÏ1 4
.
ÏÏ4 5
HttpStatusCode
ÏÏ5 C
.
ÏÏC D

BadRequest
ÏÏD N
;
ÏÏN O
}
ÌÌ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
 
response
ÒÒ 
.
ÒÒ 
Mensaje
ÒÒ  
=
ÒÒ! "$
ExceptionMessageHelper
ÒÒ# 9
.
ÒÒ9 :!
GetExceptionMessage
ÒÒ: M
(
ÒÒM N
ex
ÒÒN P
)
ÒÒP Q
;
ÒÒQ R
response
ÚÚ 
.
ÚÚ 

StatusCode
ÚÚ #
=
ÚÚ$ %
System
ÚÚ& ,
.
ÚÚ, -
Net
ÚÚ- 0
.
ÚÚ0 1
HttpStatusCode
ÚÚ1 ?
.
ÚÚ? @

BadRequest
ÚÚ@ J
;
ÚÚJ K
}
ÛÛ 
return
ıı 
await
ıı 
Task
ıı 
.
ıı 

FromResult
ıı (
(
ıı( )
response
ıı) 1
)
ıı1 2
;
ıı2 3
}
ˆˆ 	
private
¸¸ 
async
¸¸ 
Task
¸¸ 
<
¸¸ 
ResponseDTO
¸¸ &
>
¸¸& '
SaveBackUpServer
¸¸( 8
(
¸¸8 9
)
¸¸9 :
{
˝˝ 	
ResponseDTO
˛˛ 
response
˛˛  
=
˛˛! "
new
˛˛# &
ResponseDTO
˛˛' 2
{
˛˛3 4
	IsExitoso
˛˛5 >
=
˛˛? @
false
˛˛A F
}
˛˛G H
;
˛˛H I
var
ÄÄ 
date
ÄÄ 
=
ÄÄ 
DateTime
ÄÄ 
.
ÄÄ  
Now
ÄÄ  #
.
ÄÄ# $
ToString
ÄÄ$ ,
(
ÄÄ, -
$str
ÄÄ- 0
)
ÄÄ0 1
.
ÄÄ1 2
Replace
ÄÄ2 9
(
ÄÄ9 :
$str
ÄÄ: =
,
ÄÄ= >
$str
ÄÄ? B
)
ÄÄB C
;
ÄÄC D
string
ÅÅ 
name
ÅÅ 
=
ÅÅ 
Path
ÅÅ 
.
ÅÅ )
GetFileNameWithoutExtension
ÅÅ :
(
ÅÅ: ;
this
ÅÅ; ?
.
ÅÅ? @
fileName
ÅÅ@ H
!
ÅÅH I
)
ÅÅI J
;
ÅÅJ K
string
ÇÇ 
	extension
ÇÇ 
=
ÇÇ 
Path
ÇÇ #
.
ÇÇ# $
GetExtension
ÇÇ$ 0
(
ÇÇ0 1
this
ÇÇ1 5
.
ÇÇ5 6
fileName
ÇÇ6 >
!
ÇÇ> ?
)
ÇÇ? @
;
ÇÇ@ A
string
ÑÑ 

sourcePath
ÑÑ 
=
ÑÑ 
@$"
ÑÑ  #
{
ÑÑ# $
this
ÑÑ$ (
.
ÑÑ( )%
uploadServerFileUrlPath
ÑÑ) @
}
ÑÑ@ A
{
ÑÑA B
this
ÑÑB F
.
ÑÑF G&
uploadServerFolderSource
ÑÑG _
}
ÑÑ_ `
{
ÑÑ` a
this
ÑÑa e
.
ÑÑe f
fileName
ÑÑf n
}
ÑÑn o
"
ÑÑo p
;
ÑÑp q
try
ÜÜ 
{
áá 
if
ââ 
(
ââ 
File
ââ 
.
ââ 
Exists
ââ 
(
ââ  

sourcePath
ââ  *
)
ââ* +
)
ââ+ ,
{
ää 
byte
ãã 
[
ãã 
]
ãã 
bytes
ãã  
=
ãã! "
await
ãã# (
File
ãã) -
.
ãã- .
ReadAllBytesAsync
ãã. ?
(
ãã? @

sourcePath
ãã@ J
)
ããJ K
;
ããK L
string
èè 
originalName
èè '
=
èè( )
fileName
èè* 2
!
èè2 3
;
èè3 4
string
êê 
compoundName
êê '
=
êê( )
$"
êê* ,
{
êê, -
name
êê- 1
}
êê1 2
$str
êê2 4
{
êê4 5
date
êê5 9
}
êê9 :
$str
êê: ;
{
êê; <
	extension
êê< E
}
êêE F
"
êêF G
;
êêG H
var
íí 
result
íí 
=
íí  
await
íí! &"
_portfolioRepository
íí' ;
.
íí; <
SaveFileBase64
íí< J
(
ííJ K
originalName
ííK W
,
ííW X
compoundName
ííY e
,
ííe f
bytes
ííg l
,
ííl m
$str
íín v
)
íív w
;
ííw x
response
îî 
.
îî 
	IsExitoso
îî &
=
îî' (
result
îî) /
;
îî/ 0
}
ïï 
else
ññ 
{
óó 
response
òò 
.
òò 
Mensaje
òò $
=
òò% &
$str
òò' 4
+
òò5 6

sourcePath
òò7 A
+
òòB C
$str
òòD Q
;
òòQ R
response
ôô 
.
ôô 

StatusCode
ôô '
=
ôô( )
System
ôô* 0
.
ôô0 1
Net
ôô1 4
.
ôô4 5
HttpStatusCode
ôô5 C
.
ôôC D

BadRequest
ôôD N
;
ôôN O
}
öö 
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
ex
úú 
)
úú  
{
ùù 
response
ûû 
.
ûû 
Mensaje
ûû  
=
ûû! "$
ExceptionMessageHelper
ûû# 9
.
ûû9 :!
GetExceptionMessage
ûû: M
(
ûûM N
ex
ûûN P
)
ûûP Q
;
ûûQ R
response
üü 
.
üü 

StatusCode
üü #
=
üü$ %
System
üü& ,
.
üü, -
Net
üü- 0
.
üü0 1
HttpStatusCode
üü1 ?
.
üü? @

BadRequest
üü@ J
;
üüJ K
}
†† 
return
¢¢ 
response
¢¢ 
;
¢¢ 
}
££ 	
private
™™ 
async
™™ 
Task
™™ 
<
™™ 
ResponseDTO
™™ &
>
™™& ' 
SaveBackUpEndPoint
™™( :
(
™™: ;
	IFormFile
™™; D
file
™™E I
)
™™I J
{
´´ 	
ResponseDTO
¨¨ 
response
¨¨  
=
¨¨! "
new
¨¨# &
ResponseDTO
¨¨' 2
{
¨¨3 4
	IsExitoso
¨¨5 >
=
¨¨? @
false
¨¨A F
}
¨¨G H
;
¨¨H I
try
ÆÆ 
{
ØØ 
string
∞∞ 
originalName
∞∞ #
=
∞∞$ %
file
∞∞& *
.
∞∞* +
FileName
∞∞+ 3
;
∞∞3 4
var
±± 
date
±± 
=
±± 
DateTime
±± #
.
±±# $
Now
±±$ '
.
±±' (
ToString
±±( 0
(
±±0 1
$str
±±1 4
)
±±4 5
.
±±5 6
Replace
±±6 =
(
±±= >
$str
±±> A
,
±±A B
$str
±±C F
)
±±F G
;
±±G H
string
≤≤ 
name
≤≤ 
=
≤≤ 
Path
≤≤ "
.
≤≤" #)
GetFileNameWithoutExtension
≤≤# >
(
≤≤> ?
originalName
≤≤? K
)
≤≤K L
;
≤≤L M
string
≥≥ 
	extension
≥≥  
=
≥≥! "
Path
≥≥# '
.
≥≥' (
GetExtension
≥≥( 4
(
≥≥4 5
originalName
≥≥5 A
)
≥≥A B
;
≥≥B C
string
¥¥ 
compoundName
¥¥ #
=
¥¥$ %
$"
¥¥& (
{
¥¥( )
name
¥¥) -
}
¥¥- .
$str
¥¥. 0
{
¥¥0 1
date
¥¥1 5
}
¥¥5 6
$str
¥¥6 7
{
¥¥7 8
	extension
¥¥8 A
}
¥¥A B
"
¥¥B C
;
¥¥C D
using
∂∂ 
(
∂∂ 
MemoryStream
∂∂ #
memoryStream
∂∂$ 0
=
∂∂1 2
new
∂∂3 6
MemoryStream
∂∂7 C
(
∂∂C D
)
∂∂D E
)
∂∂E F
{
∑∑ 
await
∏∏ 
file
∏∏ 
.
∏∏ 
CopyToAsync
∏∏ *
(
∏∏* +
memoryStream
∏∏+ 7
)
∏∏7 8
;
∏∏8 9
byte
ππ 
[
ππ 
]
ππ 
bytes
ππ  
=
ππ! "
memoryStream
ππ# /
.
ππ/ 0
ToArray
ππ0 7
(
ππ7 8
)
ππ8 9
;
ππ9 :
var
»» 
result
»» 
=
»»  
await
»»! &"
_portfolioRepository
»»' ;
.
»»; <
SaveFileBase64
»»< J
(
»»J K
originalName
»»K W
,
»»W X
compoundName
»»Y e
,
»»e f
bytes
»»g l
,
»»l m
$str
»»n x
)
»»x y
;
»»y z
response
…… 
.
…… 
	IsExitoso
…… &
=
……' (
result
……) /
;
……/ 0
}
   
}
ÀÀ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÕÕ 
response
ŒŒ 
.
ŒŒ 
Mensaje
ŒŒ  
=
ŒŒ! "$
ExceptionMessageHelper
ŒŒ# 9
.
ŒŒ9 :!
GetExceptionMessage
ŒŒ: M
(
ŒŒM N
ex
ŒŒN P
)
ŒŒP Q
;
ŒŒQ R
response
œœ 
.
œœ 

StatusCode
œœ #
=
œœ$ %
System
œœ& ,
.
œœ, -
Net
œœ- 0
.
œœ0 1
HttpStatusCode
œœ1 ?
.
œœ? @

BadRequest
œœ@ J
;
œœJ K
}
–– 
return
““ 
response
““ 
;
““ 
}
”” 	
public
›› 
async
›› 
Task
›› 
<
›› 
ResponseDTO
›› %
>
››% &

GetFileCSV
››' 1
(
››1 2
string
››2 8
fileDate
››9 A
)
››A B
{
ﬁﬁ 	
ResponseDTO
ﬂﬂ 
response
ﬂﬂ  
=
ﬂﬂ! "
new
ﬂﬂ# &
ResponseDTO
ﬂﬂ' 2
{
ﬂﬂ3 4
	IsExitoso
ﬂﬂ5 >
=
ﬂﬂ? @
false
ﬂﬂA F
}
ﬂﬂG H
;
ﬂﬂH I
try
·· 
{
‚‚ 
response
„„ 
=
„„ 
await
„„  "
_portfolioRepository
„„! 5
.
„„5 6
ReadOracleBLOB
„„6 D
(
„„D E
fileDate
„„E M
)
„„M N
;
„„N O
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÊÊ 
response
ÁÁ 
.
ÁÁ 
Mensaje
ÁÁ  
=
ÁÁ! "$
ExceptionMessageHelper
ÁÁ# 9
.
ÁÁ9 :!
GetExceptionMessage
ÁÁ: M
(
ÁÁM N
ex
ÁÁN P
)
ÁÁP Q
;
ÁÁQ R
response
ËË 
.
ËË 

StatusCode
ËË #
=
ËË$ %
System
ËË& ,
.
ËË, -
Net
ËË- 0
.
ËË0 1
HttpStatusCode
ËË1 ?
.
ËË? @

BadRequest
ËË@ J
;
ËËJ K
}
ÈÈ 
return
ÎÎ 
response
ÎÎ 
;
ÎÎ 
}
ÏÏ 	
}
ÓÓ 
} ˜v
´D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\UseCases\UserUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
UseCases& .
{ 
public 

class 
UserUseCase 
: 
IUserUseCase +
{ 
private 
readonly $
IAuthorizationRepository 1$
_authorizationRepository2 J
;J K
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
IUserRepository (
_userRepository) 8
;8 9
private 
readonly 
PasswordHasher '
<' (
Usuario( /
>/ 0
_passwordHasher1 @
;@ A
public 
UserUseCase 
( $
IAuthorizationRepository 3#
authorizationRepository4 K
,K L
IConfigurationM [
configuration\ i
,i j
IUserRepositoryk z
userRepository	{ â
)
â ä
{ 	$
_authorizationRepository $
=% &#
authorizationRepository' >
;> ?
_configuration 
= 
configuration *
;* +
_userRepository 
= 
userRepository ,
;, -
_passwordHasher 
= 
new !
PasswordHasher" 0
<0 1
Usuario1 8
>8 9
(9 :
): ;
;; <
}   	
public'' 
async'' 
Task'' 
<'' 
ResponseDTO'' %
>''% &
Login''' ,
('', -
LoginRequestDTO''- <
request''= D
)''D E
{(( 	
ResponseDTO)) 
response))  
=))! "
new))# &
ResponseDTO))' 2
())2 3
)))3 4
;))4 5
try++ 
{,, 
var-- 
allUsers-- 
=-- 
await-- $
_userRepository--% 4
.--4 5
GetAllAsync--5 @
(--@ A
)--A B
;--B C
var.. 
user.. 
=.. 
allUsers.. #
...# $
FirstOrDefault..$ 2
(..2 3
u..3 4
=>..5 7
u..8 9
...9 :
UserName..: B
...B C
Trim..C G
(..G H
)..H I
...I J
ToLower..J Q
(..Q R
)..R S
==..T V
request..W ^
...^ _
Username.._ g
!..g h
...h i
Trim..i m
(..m n
)..n o
...o p
ToLower..p w
(..w x
)..x y
)..y z
;..z {
var// 
result// 
=// 
this// !
.//! "
VerifyPassword//" 0
(//0 1
user//1 5
!//5 6
,//6 7
request//8 ?
.//? @
Password//@ H
!//H I
)//I J
;//J K
if11 
(11 
!11 
result11 
)11 
{22 
response33 
.33 
	IsExitoso33 &
=33' (
false33) .
;33. /
response44 
.44 
ErrorMessages44 *
.44* +
Add44+ .
(44. /
$str44/ R
)44R S
;44S T
response55 
.55 

StatusCode55 '
=55( )
HttpStatusCode55* 8
.558 9

BadRequest559 C
;55C D
return66 
response66 #
;66# $
}77 
string99 
	secretKey99  
=99! "
string99# )
.99) *
Empty99* /
;99/ 0
string:: 
environmentVariable:: *
=::+ ,
Environment::- 8
.::8 9"
GetEnvironmentVariable::9 O
(::O P
$str::P j
)::j k
!::k l
;::l m
if;; 
(;; 
!;; 
string;; 
.;; 
IsNullOrEmpty;; )
(;;) *
environmentVariable;;* =
);;= >
);;> ?
{<< 
var== 
data== 
=== 
JsonConvert== *
.==* +
DeserializeObject==+ <
<==< = 
EnvironmentVariables=== Q
>==Q R
(==R S
environmentVariable==S f
!==f g
)==g h
;==h i
	secretKey>> 
=>> 
data>>  $
!>>$ %
.>>% &
Secret>>& ,
;>>, -
}?? 
intAA 
accessTokenTimeAA #
=AA$ %
intAA& )
.AA) *
ParseAA* /
(AA/ 0
_configurationAA0 >
.AA> ?
GetValueAA? G
<AAG H
stringAAH N
>AAN O
(AAO P
$strAAP m
)AAm n
!AAn o
)AAo p
;AAp q
stringBB 
tokenCreatedBB #
=BB$ %
TokenHelperBB& 1
.BB1 2
GenerateAccessTokenBB2 E
(BBE F
userBBF J
!BBJ K
,BBK L
	secretKeyBBM V
,BBV W
accessTokenTimeBBX g
)BBg h
;BBh i
stringCC 
refreshTokenCreatedCC *
=CC+ ,
TokenHelperCC- 8
.CC8 9 
GenerateRefreshTokenCC9 M
(CCM N
)CCN O
;CCO P
intEE 
refreshTokenTimeEE $
=EE% &
intEE' *
.EE* +
ParseEE+ 0
(EE0 1
_configurationEE1 ?
.EE? @
GetValueEE@ H
<EEH I
stringEEI O
>EEO P
(EEP Q
$strEEQ o
)EEo p
!EEp q
)EEq r
;EEr s
responseFF 
=FF 
awaitFF  
TokenHelperFF! ,
.FF, -
SaveRefreshTokenFF- =
(FF= >
userFF> B
!FFB C
.FFC D
IdFFD F
,FFF G
tokenCreatedFFH T
,FFT U
refreshTokenCreatedFFV i
,FFi j
refreshTokenTimeFFk {
,FF{ |%
_authorizationRepository	FF} ï
)
FFï ñ
;
FFñ ó
ifGG 
(GG 
responseGG 
.GG 
	IsExitosoGG &
)GG& '
{HH 
varJJ 
userDataJJ  
=JJ! "
newJJ# &
UserDTOJJ' .
{KK 
NombreLL 
=LL  
userLL! %
.LL% &
NombreLL& ,
,LL, -
UserNameMM  
=MM! "
userMM# '
.MM' (
UserNameMM( 0
}NN 
;NN 
varOO 
	tokenDataOO !
=OO" #
(OO$ %
TokenDTOOO% -
)OO- .
responseOO. 6
.OO6 7
	ResultadoOO7 @
!OO@ A
;OOA B
responseQQ 
.QQ 
	ResultadoQQ &
=QQ' (
newQQ) ,
{RR 
userNameSS  
=SS! "
userDataSS# +
.SS+ ,
UserNameSS, 4
,SS4 5
nombreTT 
=TT  
userDataTT! )
.TT) *
NombreTT* 0
,TT0 1
accessTokenUU #
=UU$ %
	tokenDataUU& /
.UU/ 0
AccessTokenUU0 ;
,UU; <
refreshTokenVV $
=VV% &
	tokenDataVV' 0
.VV0 1
RefreshTokenVV1 =
}WW 
;WW 
}XX 
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 
response\\ 
.\\ 
	IsExitoso\\ "
=\\# $
false\\% *
;\\* +
response]] 
.]] 
ErrorMessages]] &
.]]& '
Add]]' *
(]]* +"
ExceptionMessageHelper]]+ A
.]]A B
GetExceptionMessage]]B U
(]]U V
ex]]V X
)]]X Y
)]]Y Z
;]]Z [
response^^ 
.^^ 

StatusCode^^ #
=^^$ %
HttpStatusCode^^& 4
.^^4 5

BadRequest^^5 ?
;^^? @
}__ 
returnaa 
responseaa 
;aa 
}bb 	
publicii 
asyncii 
Taskii 
<ii 
ResponseDTOii %
>ii% &
Registerii' /
(ii/ 0
RegistroRequestDTOii0 B
requestiiC J
)iiJ K
{jj 	
ResponseDTOkk 
responsekk  
=kk! "
newkk# &
ResponseDTOkk' 2
(kk2 3
)kk3 4
;kk4 5
trymm 
{nn 
varoo 
isUsuarioUnicooo "
=oo# $
thisoo% )
.oo) *
IsUsuarioUnicooo* 8
(oo8 9
requestoo9 @
.oo@ A
UserNameooA I
)ooI J
;ooJ K
ifqq 
(qq 
isUsuarioUnicoqq "
)qq" #
{rr 
responsess 
.ss 
	IsExitososs &
=ss' (
falsess) .
;ss. /
responsett 
.tt 
ErrorMessagestt *
.tt* +
Addtt+ .
(tt. /
$strtt/ F
)ttF G
;ttG H
responseuu 
.uu 

StatusCodeuu '
=uu( )
HttpStatusCodeuu* 8
.uu8 9

BadRequestuu9 C
;uuC D
returnvv 
responsevv #
;vv# $
}ww 
Usuarioyy 
usuarioyy 
=yy  !
newyy" %
(yy% &
)yy& '
{zz 
Nombre{{ 
={{ 
request{{ $
.{{$ %
Nombre{{% +
,{{+ ,
Password|| 
=|| 
request|| &
.||& '
Password||' /
,||/ 0
Rol}} 
=}} 
request}} !
.}}! "
Rol}}" %
,}}% &
UserName~~ 
=~~ 
request~~ &
.~~& '
UserName~~' /
} 
; 
usuario
ÇÇ 
.
ÇÇ 
Password
ÇÇ  
=
ÇÇ! "
_passwordHasher
ÇÇ# 2
.
ÇÇ2 3
HashPassword
ÇÇ3 ?
(
ÇÇ? @
usuario
ÇÇ@ G
,
ÇÇG H
request
ÇÇI P
.
ÇÇP Q
Password
ÇÇQ Y
)
ÇÇY Z
;
ÇÇZ [
var
ÑÑ 
userAdd
ÑÑ 
=
ÑÑ 
await
ÑÑ #
_userRepository
ÑÑ$ 3
.
ÑÑ3 4
AddAsync
ÑÑ4 <
(
ÑÑ< =
usuario
ÑÑ= D
)
ÑÑD E
;
ÑÑE F
usuario
ÖÖ 
.
ÖÖ 
Id
ÖÖ 
=
ÖÖ 
this
ÖÖ !
.
ÖÖ! "
GetUserByUserName
ÖÖ" 3
(
ÖÖ3 4
request
ÖÖ4 ;
.
ÖÖ; <
UserName
ÖÖ< D
)
ÖÖD E
.
ÖÖE F
Id
ÖÖF H
;
ÖÖH I
response
áá 
.
áá 
	IsExitoso
áá "
=
áá# $
userAdd
áá% ,
>
áá- .
$num
áá/ 0
;
áá0 1
response
àà 
.
àà 
Mensaje
àà  
=
àà! "
response
àà# +
.
àà+ ,
	IsExitoso
àà, 5
?
àà6 7
$str
àà8 U
:
ààV W
$str
ààX z
;
ààz {
usuario
ââ 
.
ââ 
Password
ââ  
=
ââ! "
$str
ââ# %
;
ââ% &
response
ää 
.
ää 
	Resultado
ää "
=
ää# $
usuario
ää% ,
;
ää, -
response
ãã 
.
ãã 

StatusCode
ãã #
=
ãã$ %
HttpStatusCode
ãã& 4
.
ãã4 5
OK
ãã5 7
;
ãã7 8
}
çç 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
èè 
response
êê 
.
êê 
	IsExitoso
êê "
=
êê# $
false
êê% *
;
êê* +
response
ëë 
.
ëë 
Mensaje
ëë  
=
ëë! "$
ExceptionMessageHelper
ëë# 9
.
ëë9 :!
GetExceptionMessage
ëë: M
(
ëëM N
ex
ëëN P
)
ëëP Q
;
ëëQ R
response
íí 
.
íí 

StatusCode
íí #
=
íí$ %
HttpStatusCode
íí& 4
.
íí4 5

BadRequest
íí5 ?
;
íí? @
}
ìì 
return
îî 
response
îî 
;
îî 
}
ïï 	
private
¸¸ 
Usuario
¸¸ 
GetUserByUserName
¸¸ )
(
¸¸) *
string
¸¸* 0
userName
¸¸1 9
)
¸¸9 :
{
˝˝ 	
var
˛˛ 
usuario
˛˛ 
=
˛˛ 
_userRepository
˛˛ )
.
˛˛) *
GetAllAsync
˛˛* 5
(
˛˛5 6
)
˛˛6 7
.
˛˛7 8
Result
˛˛8 >
.
˛˛> ?
FirstOrDefault
˛˛? M
(
˛˛M N
u
˛˛N O
=>
˛˛P R
u
˛˛S T
.
˛˛T U
UserName
˛˛U ]
.
˛˛] ^
ToLower
˛˛^ e
(
˛˛e f
)
˛˛f g
==
˛˛h j
userName
˛˛k s
.
˛˛s t
ToLower
˛˛t {
(
˛˛{ |
)
˛˛| }
)
˛˛} ~
;
˛˛~ 
return
ˇˇ 
usuario
ˇˇ 
!
ˇˇ 
;
ˇˇ 
}
ÄÄ 	
private
áá 
bool
áá 
IsUsuarioUnico
áá #
(
áá# $
string
áá$ *
userName
áá+ 3
)
áá3 4
{
àà 	
var
ââ 
usuario
ââ 
=
ââ 
_userRepository
ââ )
.
ââ) *
GetAllAsync
ââ* 5
(
ââ5 6
)
ââ6 7
.
ââ7 8
Result
ââ8 >
.
ââ> ?
FirstOrDefault
ââ? M
(
ââM N
u
ââN O
=>
ââP R
u
ââS T
.
ââT U
UserName
ââU ]
.
ââ] ^
ToLower
ââ^ e
(
ââe f
)
ââf g
==
ââh j
userName
ââk s
.
ââs t
ToLower
âât {
(
ââ{ |
)
ââ| }
)
ââ} ~
;
ââ~ 
if
ää 
(
ää 
usuario
ää 
==
ää 
null
ää 
)
ää  
{
ãã 
return
åå 
false
åå 
;
åå 
}
çç 
return
éé 
true
éé 
;
éé 
}
èè 	
public
óó 
bool
óó 
VerifyPassword
óó "
(
óó" #
Usuario
óó# *
user
óó+ /
,
óó/ 0
string
óó1 7
password
óó8 @
)
óó@ A
{
òò 	
var
ôô 
result
ôô 
=
ôô 
_passwordHasher
ôô (
.
ôô( )"
VerifyHashedPassword
ôô) =
(
ôô= >
user
ôô> B
,
ôôB C
user
ôôD H
.
ôôH I
Password
ôôI Q
,
ôôQ R
password
ôôS [
)
ôô[ \
;
ôô\ ]
return
öö 
result
öö 
==
öö (
PasswordVerificationResult
öö 7
.
öö7 8
Success
öö8 ?
;
öö? @
}
õõ 	
}
üü 
}°° ï:
¥D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\UseCases\AuthorizationUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
UseCases& .
{ 
public 

class  
AuthorizationUseCase %
:& '!
IAuthorizationUseCase( =
{ 
private 
readonly $
IAuthorizationRepository 1$
_authorizationRepository2 J
;J K
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
IUserRepository (
_userRepository) 8
;8 9
public  
AuthorizationUseCase #
(# $$
IAuthorizationRepository$ <#
authorizationRepository= T
,T U
IConfigurationV d
configuratione r
,r s
IUserRepository	t É
userRepository
Ñ í
)
í ì
{ 	$
_authorizationRepository $
=% &#
authorizationRepository' >
;> ?
_configuration 
= 
configuration *
;* +
_userRepository 
= 
userRepository ,
;, -
} 	
public'' 
async'' 
Task'' 
<'' 
ResponseDTO'' %
>''% &&
GenerateRefreshAccessToken''' A
(''A B
TokenDTO''B J
request''K R
)''R S
{(( 	
ResponseDTO)) 
response))  
=))! "
new))# &
ResponseDTO))' 2
())2 3
)))3 4
;))4 5
try++ 
{,, 
var.. 
	allTokens.. 
=.. 
await..  %$
_authorizationRepository..& >
...> ?
GetAllAsync..? J
(..J K
)..K L
;..L M
var// 
refreshTokenExpired// '
=//( )
	allTokens//* 3
.//3 4
FirstOrDefault//4 B
(//B C
x//C D
=>//E G
x//H I
.//I J
RefreshToken//J V
==//W Y
request//Z a
.//a b
RefreshToken//b n
&&//o q
x//r s
.//s t
IsValid//t {
==//| ~
true	// É
)
//É Ñ
;
//Ñ Ö
if00 
(00 
refreshTokenExpired00 '
==00( *
null00+ /
)00/ 0
{11 
response22 
.22 
	IsExitoso22 &
=22' (
false22) .
;22. /
response33 
.33 
ErrorMessages33 *
.33* +
Add33+ .
(33. /
$str33/ V
)33V W
;33W X
response44 
.44 

StatusCode44 '
=44( )
HttpStatusCode44* 8
.448 9

BadRequest449 C
;44C D
return55 
response55 #
;55# $
}66 
var88 
tokenHandler88  
=88! "
new88# &#
JwtSecurityTokenHandler88' >
(88> ?
)88? @
;88@ A
var99 
expiredToken99  
=99! "
tokenHandler99# /
.99/ 0
ReadJwtToken990 <
(99< =
request99= D
.99D E
AccessToken99E P
)99P Q
;99Q R
if:: 
(:: 
expiredToken::  
.::  !
ValidTo::! (
>::) *
DateTime::+ 3
.::3 4
UtcNow::4 :
)::: ;
{;; 
response<< 
.<< 
	IsExitoso<< &
=<<' (
false<<) .
;<<. /
response== 
.== 
Mensaje== $
===% &
$str==' A
;==A B
response>> 
.>> 

StatusCode>> '
=>>( )
HttpStatusCode>>* 8
.>>8 9

BadRequest>>9 C
;>>C D
return?? 
response?? #
;??# $
}@@ 
varBB 
refreshTokenCreatedBB '
=BB( )
TokenHelperBB* 5
.BB5 6 
GenerateRefreshTokenBB6 J
(BBJ K
)BBK L
;BBL M
varEE 
userEE 
=EE 
awaitEE  
_userRepositoryEE! 0
.EE0 1
GetByIdAsyncEE1 =
(EE= >
intEE> A
.EEA B
ParseEEB G
(EEG H
refreshTokenExpiredEEH [
.EE[ \
	UsuarioIdEE\ e
!EEe f
)EEf g
)EEg h
;EEh i
stringGG 
	secretKeyGG  
=GG! "
_configurationGG# 1
.GG1 2
GetValueGG2 :
<GG: ;
stringGG; A
>GGA B
(GGB C
$strGGC W
)GGW X
!GGX Y
;GGY Z
intHH 
accessTokenTimeHH #
=HH$ %
intHH& )
.HH) *
ParseHH* /
(HH/ 0
_configurationHH0 >
.HH> ?
GetValueHH? G
<HHG H
stringHHH N
>HHN O
(HHO P
$strHHP m
)HHm n
!HHn o
)HHo p
;HHp q
varII 
tokenCreatedII  
=II! "
TokenHelperII# .
.II. /
GenerateAccessTokenII/ B
(IIB C
userIIC G
,IIG H
	secretKeyIII R
,IIR S
accessTokenTimeIIT c
)IIc d
;IId e
refreshTokenExpiredLL #
.LL# $
ExpirationDateLL$ 2
=LL3 4
DateTimeLL5 =
.LL= >
MinValueLL> F
;LLF G
varPP 
updateTokenPP 
=PP  !
awaitPP" '$
_authorizationRepositoryPP( @
.PP@ A
UpdateAsyncPPA L
(PPL M
refreshTokenExpiredPPM `
)PP` a
;PPa b
intRR 
refreshTokenTimeRR $
=RR% &
intRR' *
.RR* +
ParseRR+ 0
(RR0 1
_configurationRR1 ?
.RR? @
GetValueRR@ H
<RRH I
stringRRI O
>RRO P
(RRP Q
$strRRQ o
)RRo p
!RRp q
)RRq r
;RRr s
responseSS 
=SS 
awaitSS  
TokenHelperSS! ,
.SS, -
SaveRefreshTokenSS- =
(SS= >
userSS> B
.SSB C
IdSSC E
,SSE F
tokenCreatedSSG S
,SSS T
refreshTokenCreatedSSU h
,SSh i
refreshTokenTimeSSj z
,SSz {%
_authorizationRepository	SS| î
)
SSî ï
;
SSï ñ
}TT 
catchUU 
(UU 
	ExceptionUU 
exUU 
)UU  
{VV 
responseWW 
.WW 
	IsExitosoWW "
=WW# $
falseWW% *
;WW* +
responseXX 
.XX 
MensajeXX  
=XX! ""
ExceptionMessageHelperXX# 9
.XX9 :
GetExceptionMessageXX: M
(XXM N
exXXN P
)XXP Q
;XXQ R
responseYY 
.YY 

StatusCodeYY #
=YY$ %
HttpStatusCodeYY& 4
.YY4 5

BadRequestYY5 ?
;YY? @
}ZZ 
return\\ 
response\\ 
;\\ 
}]] 	
}__ 
}aa 
±D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Mapping\AutoMappingProfile.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
Mapping& -
{ 
public

 

class

 
AutoMappingProfile

 #
:

$ %
Profile

& -
{ 
public 
AutoMappingProfile !
(! "
)" #
{ 	
	CreateMap 
< 

Portafolio  
,  !
PortafolioDTO" /
>/ 0
(0 1
)1 2
.2 3
	ForMember3 <
(< =
x= >
=>? A
xB C
.C D

ListaDatosD N
,N O
listP T
=>U W
listX \
.\ ]
MapFrom] d
(d e
ListaDatosMAPe r
)r s
)s t
;t u
	CreateMap 
< 
PortafolioDTO #
,# $

Portafolio% /
>/ 0
(0 1
)1 2
;2 3
	CreateMap 
< 

Portafolio  
,  !
PortafolioCreateDTO" 5
>5 6
(6 7
)7 8
.8 9

ReverseMap9 C
(C D
)D E
;E F
	CreateMap 
< 

Portafolio  
,  !
PortafolioUpdateDTO" 5
>5 6
(6 7
)7 8
.8 9

ReverseMap9 C
(C D
)D E
;E F
	CreateMap 
< 
Usuario 
, 
UserDTO &
>& '
(' (
)( )
.) *

ReverseMap* 4
(4 5
)5 6
;6 7
} 	
public 
List 
< 
ListaDatosDTO !
>! "
ListaDatosMAP# 0
(0 1

Portafolio1 ;

portafolio< F
,F G
PortafolioDTOH U
portafolioDtoV c
)c d
{ 	
var 
source 
= 
JsonConvert $
.$ %
DeserializeObject% 6
<6 7
List7 ;
<; <
ListaDatosDTO< I
>I J
>J K
(K L

portafolioL V
.V W

ListaDatosW a
!a b
)b c
;c d
return 
source 
! 
; 
} 	
} 
}   Ì
≥D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\User\IUserUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
User1 5
{ 
public

 

	interface

 
IUserUseCase

 !
{ 
Task 
< 
ResponseDTO 
> 
Login 
(  
LoginRequestDTO  /
request0 7
)7 8
;8 9
Task 
< 
ResponseDTO 
> 
Register "
(" #
RegistroRequestDTO# 5
request6 =
)= >
;> ?
} 
} ˇ
ΩD:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\Portfolio\IPortfolioUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
	Portfolio1 :
{ 
public 

	interface 
IPortfolioUseCase &
{ 
Task 
< 
ResponseDTO 
> 
GetAllPortfolio )
() *
)* +
;+ ,
Task 
< 
ResponseDTO 
> 
GetPortfolioByDate ,
(, -
string- 3
positionDate4 @
)@ A
;A B
Task   
<   
ResponseDTO   
>   
GetPortfolioById   *
(  * +
int  + .
id  / 1
)  1 2
;  2 3
Task'' 
<'' 
ResponseDTO'' 
>'' 
CreatePortfolio'' )
('') *
PortafolioCreateDTO''* =
request''> E
)''E F
;''F G
Task// 
<// 
ResponseDTO// 
>// 
UpdatePortfolio// )
(//) *
int//* -
portafolioId//. :
,//: ;
PortafolioUpdateDTO//< O
request//P W
)//W X
;//X Y
Task66 
<66 
ResponseDTO66 
>66 
DeletePortfolio66 )
(66) *
int66* -
id66. 0
)660 1
;661 2
Task== 
<== 
ResponseDTO== 
>== 
	ExcelLoad== #
(==# $
	IFormFile==$ -
file==. 2
)==2 3
;==3 4
TaskDD 
<DD 
ResponseDTODD 
>DD 

GetFileCSVDD $
(DD$ %
stringDD% +
fileDateDD, 4
)DD4 5
;DD5 6
}FF 
}HH Ì

∂D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\User\IUserRepository.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
User1 5
{ 
public		 

	interface		 
IUserRepository		 $
{

 
Task 
< 
int 
> 
AddAsync 
( 
Usuario "
entity# )
)) *
;* +
Task 
< 
bool 
> 
DeleteAsync 
( 
int "
id# %
)% &
;& '
Task 
< 
IEnumerable 
< 
Usuario  
>  !
>! "
GetAllAsync# .
(. /
)/ 0
;0 1
Task   
<   
Usuario   
>   
GetByIdAsync   "
(  " #
int  # &
id  ' )
)  ) *
;  * +
Task"" 
<"" 
bool"" 
>"" 
UpdateAsync"" 
("" 
Usuario"" &
entity""' -
)""- .
;"". /
}$$ 
}&& ÿ
¿D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\Portfolio\IPortfolioRepository.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
	Portfolio1 :
{ 
public

 

	interface

  
IPortfolioRepository

 )
{ 
Task 
< 
IEnumerable 
< 

Portafolio #
># $
>$ %
GetAllAsync& 1
(1 2
List2 6
<6 7
object7 =
>= >
?> ?
whereFilter@ K
=L M
nullN R
)R S
;S T
Task 
< 

Portafolio 
> 
GetByIdAsync %
(% &
int& )
id* ,
), -
;- .
Task   
<   
int   
>   
AddAsync   
(   

Portafolio   %
entity  & ,
)  , -
;  - .
Task'' 
<'' 
bool'' 
>'' 
UpdateAsync'' 
('' 

Portafolio'' )
entity''* 0
)''0 1
;''1 2
Task.. 
<.. 
bool.. 
>.. 
DeleteAsync.. 
(.. 
int.. "
id..# %
)..% &
;..& '
Task44 
<44 
IEnumerable44 
<44 
SubPortafolios44 '
>44' (
>44( )$
GetAllSubPortfoliosAsync44* B
(44B C
)44C D
;44D E
Task;; 
<;; 
List;; 
<;; 
string;; 
>;; 
>;; 
SavePortfoliosList;; -
(;;- .
List;;. 2
<;;2 3

Portafolio;;3 =
>;;= >
portafoliosList;;? N
);;N O
;;;O P
TaskEE 
<EE 
boolEE 
>EE 
SaveFileBase64EE !
(EE! "
stringEE" (
originalNameEE) 5
,EE5 6
stringEE7 =
compoundNameEE> J
,EEJ K
byteEEL P
[EEP Q
]EEQ R
stringBase64EES _
,EE_ `
stringEEa g
origenEEh n
)EEn o
;EEo p
TaskLL 
<LL 
ResponseDTOLL 
>LL 
ReadOracleBLOBLL (
(LL( )
stringLL) /
fileDateLL0 8
)LL8 9
;LL9 :
}NN 
}PP ﬁ
≈D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\Authorization\IAuthorizationUseCase.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
Authorization1 >
{ 
public

 

	interface

 !
IAuthorizationUseCase

 *
{ 
Task 
< 
ResponseDTO 
> &
GenerateRefreshAccessToken 4
(4 5
TokenDTO5 =
request> E
)E F
;F G
} 
} é
»D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Interfaces\Authorization\IAuthorizationRepository.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &

Interfaces& 0
.0 1
Authorization1 >
{ 
public		 

	interface		 $
IAuthorizationRepository		 -
{

 
Task 
< 
int 
> 
AddAsync 
( 
Token  
entity! '
)' (
;( )
Task 
< 
bool 
> 
DeleteAsync 
( 
int "
id# %
)% &
;& '
Task 
< 
IEnumerable 
< 
Token 
> 
>  
GetAllAsync! ,
(, -
)- .
;. /
Task   
<   
Token   
>   
GetByIdAsync    
(    !
int  ! $
tokenId  % ,
)  , -
;  - .
Task'' 
<'' 
bool'' 
>'' 
UpdateAsync'' 
('' 
Token'' $
entity''% +
)''+ ,
;'', -
})) 
}++  >
™D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Helpers\TokenHelper.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
Helpers& -
{ 
public 

class 
TokenHelper 
{ 
public 
static 
string 
GenerateAccessToken 0
(0 1
Usuario1 8
user9 =
,= >
string? E
tokenSecretKeyF T
,T U
intV Y
accessTokenTimeZ i
)i j
{ 	
var 
key 
= 
Encoding 
. 
ASCII $
.$ %
GetBytes% -
(- .
tokenSecretKey. <
)< =
;= >
var 
claims 
= 
new 
ClaimsIdentity +
(+ ,
), -
;- .
claims 
. 
AddClaim 
( 
new 
Claim  %
(% &#
JwtRegisteredClaimNames& =
.= >
Sub> A
,A B
userC G
.G H
IdH J
.J K
ToStringK S
(S T
)T U
)U V
)V W
;W X
claims 
. 
AddClaim 
( 
new 
Claim  %
(% &#
JwtRegisteredClaimNames& =
.= >
Iat> A
,A B
DateTimeC K
.K L
UtcNowL R
.R S
ToStringS [
([ \
)\ ]
)] ^
)^ _
;_ `
claims   
.   
AddClaim   
(   
new   
Claim    %
(  % &

ClaimTypes  & 0
.  0 1
Name  1 5
,  5 6
user  7 ;
.  ; <
UserName  < D
)  D E
)  E F
;  F G
claims!! 
.!! 
AddClaim!! 
(!! 
new!! 
Claim!!  %
(!!% &

ClaimTypes!!& 0
.!!0 1
Role!!1 5
,!!5 6
user!!7 ;
.!!; <
Rol!!< ?
)!!? @
)!!@ A
;!!A B
var## 
tokenCredentials##  
=##! "
new### &
SigningCredentials##' 9
(##9 :
new$$  
SymmetricSecurityKey$$ (
($$( )
key$$) ,
)$$, -
,$$- .
SecurityAlgorithms%% "
.%%" #
HmacSha256Signature%%# 6
)&& 
;&& 
var(( 
tokenDescriptor(( 
=((  !
new((" %#
SecurityTokenDescriptor((& =
{)) 
Subject** 
=** 
claims**  
,**  !
Expires++ 
=++ 
DateTime++ "
.++" #
UtcNow++# )
.++) *

AddMinutes++* 4
(++4 5
accessTokenTime++5 D
)++D E
,++E F
SigningCredentials,, "
=,,# $
tokenCredentials,,% 5
,,,5 6
}-- 
;-- 
var// 
tokenHandler// 
=// 
new// "#
JwtSecurityTokenHandler//# :
(//: ;
)//; <
;//< =
var00 
token00 
=00 
tokenHandler00 $
.00$ %
CreateToken00% 0
(000 1
tokenDescriptor001 @
)00@ A
;00A B
var11 
tokenCreated11 
=11 
tokenHandler11 +
.11+ ,

WriteToken11, 6
(116 7
token117 <
)11< =
;11= >
return33 
tokenCreated33 
;33  
}44 	
public:: 
static:: 
string::  
GenerateRefreshToken:: 1
(::1 2
)::2 3
{;; 	
var<< 
content<< 
=<< 
new<< 
byte<< "
[<<" #
$num<<# %
]<<% &
;<<& '
string== 
refreshToken== 
===  !
string==" (
.==( )
Empty==) .
;==. /
using>> 
(>> 
var>> 
rng>> 
=>> !
RandomNumberGenerator>> 2
.>>2 3
Create>>3 9
(>>9 :
)>>: ;
)>>; <
{?? 
rng@@ 
.@@ 
GetBytes@@ 
(@@ 
content@@ $
)@@$ %
;@@% &
refreshTokenAA 
=AA 
ConvertAA &
.AA& '
ToBase64StringAA' 5
(AA5 6
contentAA6 =
)AA= >
;AA> ?
}BB 
returnDD 
refreshTokenDD 
;DD  
}EE 	
publicOO 
staticOO 
asyncOO 
TaskOO  
<OO  !
ResponseDTOOO! ,
>OO, -
SaveRefreshTokenOO. >
(OO> ?
intOO? B
userIdOOC I
,OOI J
stringOOK Q
accessTokenOOR ]
,OO] ^
stringOO_ e
refreshTokenOOf r
,OOr s
intOOt w
refreshTokenTime	OOx à
,
OOà â&
IAuthorizationRepository
OOä ¢%
authorizationRepository
OO£ ∫
)
OO∫ ª
{PP 	
ResponseDTOQQ 
responseQQ  
=QQ! "
newQQ# &
ResponseDTOQQ' 2
(QQ2 3
)QQ3 4
;QQ4 5
trySS 
{TT 
varUU !
historialRefreshTokenUU )
=UU* +
newUU, /
TokenUU0 5
{VV 
	UsuarioIdWW 
=WW 
userIdWW  &
.WW& '
ToStringWW' /
(WW/ 0
)WW0 1
,WW1 2
AccessTokenXX 
=XX  !
accessTokenXX" -
,XX- .
RefreshTokenYY  
=YY! "
refreshTokenYY# /
,YY/ 0
ExpirationDateZZ "
=ZZ# $
DateTimeZZ% -
.ZZ- .
UtcNowZZ. 4
.ZZ4 5

AddMinutesZZ5 ?
(ZZ? @
refreshTokenTimeZZ@ P
)ZZP Q
,ZZQ R
}\\ 
;\\ 
var^^ 
token^^ 
=^^ 
await^^ !#
authorizationRepository^^" 9
.^^9 :
AddAsync^^: B
(^^B C!
historialRefreshToken^^C X
)^^X Y
;^^Y Z
response`` 
.`` 
	IsExitoso`` "
=``# $
token``% *
>``+ ,
$num``- .
;``. /
responseaa 
.aa 
Mensajeaa  
=aa! "
responseaa# +
.aa+ ,
	IsExitosoaa, 5
?aa6 7
$straa8 S
:aaT U
$straaV t
;aat u
responsebb 
.bb 
	Resultadobb "
=bb# $
newbb% (
TokenDTObb) 1
{bb2 3
AccessTokenbb4 ?
=bb@ A
accessTokenbbB M
,bbM N
RefreshTokenbbO [
=bb\ ]
refreshTokenbb^ j
}bbk l
;bbl m
responsecc 
.cc 

StatusCodecc #
=cc$ %
HttpStatusCodecc& 4
.cc4 5
OKcc5 7
;cc7 8
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
responsegg 
.gg 
	IsExitosogg "
=gg# $
falsegg% *
;gg* +
responsehh 
.hh 
ErrorMessageshh &
.hh& '
Addhh' *
(hh* +
exhh+ -
.hh- .
Messagehh. 5
)hh5 6
;hh6 7
responseii 
.ii 

StatusCodeii #
=ii$ %
HttpStatusCodeii& 4
.ii4 5

BadRequestii5 ?
;ii? @
}jj 
returnll 
responsell 
;ll 
}mm 	
}oo 
}qq Ë

µD:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\Helpers\ExceptionMessageHelper.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
Helpers& -
{ 
public 

class "
ExceptionMessageHelper '
{ 
public 
static 
string 
GetExceptionMessage 0
(0 1
	Exception1 :
	exception; D
)D E
{ 	
string 
message 
= 
	exception &
.& '
Message' .
+/ 0
$str1 4
;4 5
while 
( 
	exception 
? 
. 
InnerException ,
!=- /
null0 4
)4 5
{ 
message 
+= 
	exception $
.$ %
InnerException% 3
?3 4
.4 5
Message5 <
;< =
	exception 
= 
	exception %
.% &
InnerException& 4
!4 5
;5 6
} 
return 
message 
; 
} 	
} 
} µ
®D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\User\UserDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
User+ /
{ 
public 

class 
UserDTO 
{ 
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public		 
string		 
Nombre		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
=		+ ,
string		- 3
.		3 4
Empty		4 9
;		9 :
} 
} ®
©D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\User\TokenDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
User+ /
{ 
public 

class 
TokenDTO 
{ 
[		 	
Required			 
]		 
public

 
string

 
AccessToken

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
=

0 1
string

2 8
.

8 9
Empty

9 >
;

> ?
[ 	
Required	 
] 
public 
string 
RefreshToken "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
} 
} ˆ
≥D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\User\RegistroRequestDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
User+ /
{ 
public 

class 
RegistroRequestDTO #
{ 
[		 	
Required			 
]		 
public

 
string

 
UserName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
=

- .
string

/ 5
.

5 6
Empty

6 ;
;

; <
[ 	
Required	 
] 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
[ 	
Required	 
] 
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
[ 	
Required	 
] 
public 
string 
Rol 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
} 
} Ω
∞D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\User\LoginRequestDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
User+ /
{ 
public 

class 
LoginRequestDTO  
{ 
public 
string 
? 
Username 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
?		 
Password		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
} 
} „
ßD:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\ResponseDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
{		 
public 

class 
ResponseDTO 
{ 
public 
HttpStatusCode 

StatusCode (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
bool 
	IsExitoso 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
false. 3
;3 4
public 
List 
< 
string 
> 
ErrorMessages )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
List> B
<B C
stringC I
>I J
(J K
)K L
;L M
public 
object 
? 
	Resultado  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
Mensaje 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ¶
πD:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\Portfolio\PortafolioUpdateDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
	Portfolio+ 4
{ 
public 

class 
PortafolioUpdateDTO $
{ 
public		 
string		 
?		 

ListaDatos		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
} 
} Ã
≥D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\Portfolio\PortafolioDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
	Portfolio+ 4
{ 
public 

class 
PortafolioDTO 
{ 
public		 
int		 
IdPortafolio		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
[

 	
Required

	 
]

 
public 
string 
? 

F_Posicion !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
? 
NombrePortafolio '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
? 
SubPortafolio $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
No_Envio 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
FechaCreacion %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
FechaModificacion )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 	
Required	 
] 
public 
int 
SubPortafolioId "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
dynamic 
? 

ListaDatos "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
}!! Û

πD:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\Portfolio\PortafolioCreateDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
	Portfolio+ 4
{ 
public 

class 
PortafolioCreateDTO $
{ 
public 
string 
? 

F_Posicion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 

ListaDatos !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
? 
NombrePortafolio '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 	
Required	 
] 
public 
int 
SubPortafolioId "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} æ
≥D:\Banobras\Sistemas .NET\SST3\SIVARMER\TransicionNvaFSW\Trunk\C√≥digo\RiesgosSimefin_Oracle_2024_05_29\Riesgos.Simefin\Riesgos.Simefin.Application\DTOs\Portfolio\ListaDatosDTO.cs
	namespace 	
Riesgos
 
. 
Simefin 
. 
Application %
.% &
DTOs& *
.* +
	Portfolio+ 4
{ 
public 

class 
ListaDatosDTO 
{ 
public 
string 
? 
Fecha 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
decimal		 
?		 
Valor		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
} 
} 